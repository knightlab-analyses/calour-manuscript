<!DOCTYPE html>
<meta charset="utf-8">
<html>
<head>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  <script src="http://d3js.org/d3.v4.min.js"></script>
  <style>
    .axis path {
      display: none;
    }
    .pixel {
      /* image-rendering: pixelated; */
      padding: 0px;
      margin: 0px;
      border: 0px;
        image-rendering: optimizeSpeed;             /* STOP SMOOTHING, GIVE ME SPEED  */
        image-rendering: -moz-crisp-edges;          /* Firefox                        */
        image-rendering: -o-crisp-edges;            /* Opera                          */
        image-rendering: -webkit-optimize-contrast; /* Chrome (and eventually Safari) */
        image-rendering: pixelated;                 /* Chrome */
        image-rendering: optimize-contrast;         /* CSS3 Proposed                  */
        -ms-interpolation-mode: nearest-neighbor;   /* IE8+                           */
    }
    .axis line {
      stroke-opacity: 0.3;
      shape-rendering: crispEdges;
    }
    .line {
      fill: none;
      stroke: steelblue;
      stroke-width: 2px;
    }
  </style>

  <script>
    $(document).ready(function() {

      var yticklabels = ['NA'];
      var ids = ['NA'];
      var samples = ['NA'];
      var vlines = [];
      var xtick_pos = [];
      var xtick_labels = [];
      var field_name = '';
      var title_text = 'Experiment';

      //**********************************************************
      // following variables are set by the external python program
      // DO NOT DELETE/CHANGE
      // yticklabels go here
      var ids = ["TACAGAGGGTGCAAGCGTTAATCGGATTTACTGGGCGTAAAGCGCGCGTAGGCGGCTAATTAAGTCAAATGTGAAATCCCCGAGCTTAACTTGGGAATTGCATTCGATACTGGTTAGCTAGAGTGTGGGAGAGGATGGTAGAATTCCAGG","TACGGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGCACGCAGGCGGTCTGTTAAGTCAGATGTGAAATCCCCGGGCTTAACCTGGGAACTGCATTTGAAACTGGCAGGCTTGAGTCTTGTAGAGGGGGGTAGAATTCCAGG","TACAGAGGGTGCAAGCGTTAATCGGATTTACTGGGCGTAAAGCGCGCGTAGGCGGCCAATTAAGTCAAATGTGAAATCCCCGAGCTTAACTTGGGAATTGCATTCGATACTGGTTGGCTAGAGTGTGGGAGAGGATGGTAGAATTCCAGG","TACGGAGGGTGCAAGCGTTATCCGGATTTATTGGGTTTAAAGGGTCCGTAGGCGGATTTGTAAGTCAGTGGTGAAATCTCACAGCTTAACTGTGAAACTGCCATTGATACTGCAAGTCTTGAGTGTTGTTGAAGTAGCTGGAATAAGTAG","TACAGAGGGTGCGAGCGTTAATCGGATTTACTGGGCGTAAAGCGTGCGTAGGCGGCTGATTAAGTCGGATGTGAAATCCCTGAGCTTAACTTAGGAATTGCATTCGATACTGGTCAGCTAGAGTATGGGAGAGGATGGTAGAATTCCAGG","TACGGAGGGTGCAAGCGTTGTCCGGATTTATTGGGTTTAAAGGGTGCGCAGGTGGTTTATTAAGTCAGTGGTGAAAGACGGTCGCTCAACGATTGCAGTGCCATTGAAACTGGTAGACTTGAGTAAAGTAGAGGTGGGCGGAATTGATAG","TACGGAGGGTGCAAGCGTTATCCGGATTTATTGGGTTTAAAGGGTCCGTAGGCGGATCTGTAAGTCAGTGGTGAAATCTCATAGCTTAACTATGAAACTGCCATTGATACTGCAGGTCTTGAGTAAAGTAGAAGTGGCTGGAATAAGTAG","TACGGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGCACGCAGGCGGTCTGTCAAGTCGGATGTGAAATCCCCGGGCTCAACCTGGGAACTGCATTCGAAACTGGCAGGCTAGAGTCTTGTAGAGGGGGGTAGAATTCCAGG","TACAGAGGGTGCGAGCGTTAATCGGATTTACTGGGCGTAAAGCGTGCGTAGGCGGCTTTTTAAGTCGGATGTGAAATCCCCGAGCTTAACTTGGGAATTGCATTCGATACTGGGAAGCTAGAGTATGGGAGAGGATGGTAGAATTCCAGG","TACAGAGGGTGCGAGCGTTAATCGGATTTACTGGGCGTAAAGCGTGCGTAGGCGGCTTTTTAAGTCGGATGTGAAATCCCTGAGCTTAACTTAGGAATTGCATTCGATACTGGGAAGCTAGAGTATGGGAGAGGATGGTAGAATTCCAGG","TACGGAGGGTGCAAGCGTTATCCGGATTTATTGGGTTTAAAGGGTCCGTAGGCGGACTGATAAGTCAGTGGTGAAATCCGACAGCTTAACTGTCGAACTGCCATTGATACTGTTAGTCTTGAGTAAGGTTGAAGTGGCTGGAATAAGTAG","TACGTAGGGCGCAAGCGTTGTCCGGAATTATTGGGCGTAAAGAGCTCGTAGGCGGTTTGTCGCGTCTGGTGTGAAAACTCAAGGCTCAACCTTGAGCTTGCATCGGGTACGGGCAGACTAGAGTGTGGTAGGGGTGACTGGAATTCCTGG","TACGTAGGGTGCGAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGCAGGCGGTTTTGTAAGTCAGATGTGAAATCCCCGGGCTCAACCTGGGAACTGCGTTTGAAACTACAAGGCTAGAGTATGGTAGAGGGGGGTAGAATTCCACG","TACGGAGGATCCAAGCGTTATCCGGAATCATTGGGTTTAAAGGGTCCGTAGGCGGCTTAATAAGTCAGCGGTGAAAGTTTTTGGCTTAACCAAAAAATTGCCATTGATACTGTTAGGCTTGAATTTTTGTGAAGTAACTAGAATATGTAG","TACGGAGGATCCGAGCGTTATCCGGATTTATTGGGTTTAAAGGGTGCGTAGGCGGCACTTTAAGTCAGGGGTGAAAGACGGCAGCTCAACTGTCGCAGTGCCCTTGATACTGAAGTGCTTGAATGCGGTTGAAGACGGCGGAATGAGACA","TACAGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGCGCGTAGGTGGTTTGTTAAGTTGGATGTGAAATCCCCGGGCTCAACCTGGGAACTGCATCCAAAACTGGCAAGCTAGAGTATGGTAGAGGGTGGTGGAATTTCCTG","TACAGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGCGCGTAGGTGGTTTGTTAAGTTGAATGTGAAATCCCCGGGCTCAACCTGGGAACTGCATCCAAAACTGGCAAGCTAGAGTATGGTAGAGGGTGGTGGAATTTCCTG","TACGGAGGGTGCAAGCGTTATCCGGATTTATTGGGTTTAAAGGGTCCGTAGGCGGATCTGTAAGTCAGTGGTGAAATCTCATAGCTTAACTATGAAACTGCCATTGATACTGCAGGTCTTGAGTGAGATTGAGGTAGCTGGAATAAGTAG","TACGGAGGGTGCAAGCGTTATCCGGATTTATTGGGTTTAAAGGGTCCGTAGGCGGATTAATCAGTCAGTGGTGAAATCCCGCAGCTTAACTGTGGAACTGCCATTGATACTGTTAGTCTTGAGTGATGTTGAAGTGGCTGGAATGTGTAG","TACGGAGGGTGCAAGCGTTATCCGGATTTATTGGGTTTAAAGGGTCCGTAGGCGGACTTGTAAGTCAGTGGTGAAATCTCATAGCTTAACTATGAAACTGCCATTGATACTGCAGGTCTTGAGTAAATTTGAAGTGGCTGGAATAAGTAG","TACGGAGGATCCGAGCGTTATCCGGATTTATTGGGTTTAAAGGGTGCGTAGGCGGCTTATTAAGTCAGGGGTGAAATACGGCAGCTCAACTGTCGCAGTGCCTTTGATACTGATAAGCTTGAATGTGGTTGAAGATGGCGGAATGAGACA","TACGGAGGGTGCAAGCGTTATCCGGATTCACTGGGTTTAAAGGGAGCGTAGGTGGGTTGGTAAGTCAGAGGTGAAATCTCCGAGCTTAACTCGGAAACTGCCTTTGATACTATCAGTCTTGAATATTGTGGAGGCTAGCGGAATATGTCA","TACGTAGGTGGCGAGCGTTACTCGGAGTTACTGGGCGTAAAGGGTCCGTAGGTGGCCAATTAAGTCTGAGGTGAAAGCCTGCAGCTCAACTGCAGAACTGCCTTGGAAACTGGATGGCTAGAGTGCAGGAGAGGTAAGTGGAATTTGTGG","TACAGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGCGCGTAGGTGGTTTGTTAAGTTGGATGTGAAAGCCCCGGGCTCAACCTGGGAACTGCATCCAAAACTGGCAAGCTAGAGTACGGTAGAGGGTGGTGGAATTTCCTG","TACGAAGGGTGCAAGCGTTGTTCGGATTTATTGGGCGTAAAGCGCGCGTAGGCGGACCCGCAAGTCAGATGTGAAATCTCGAGGCTCAACCTCGAAACTGCGTCTGAAACTACGGGTCTAGAATCTCGGAGGGGGAAGGGGAATATCGCA","GACGAAGGATCCAAGCGTTATCCGGATTCATTGGGTTTAAAGGGTGCGTAGGCGGATTTGTAAGTCAGTGGTGAAAGCCGATAGCTCAACTATCGAACTGCCATTGATACTGCAGATCTAGAATATAGATGATGTTGGCGGAATATGACA","TACGAAGGCCCCAAGCGTTATCCGGAATTACTGGGCGTAAAGCGTCTGTAGGTGGTTCGGAAAGTTTCAAGTGAAAGGTCAGGGCTCAACCCTGTACTTGCTTGGAAAACTATCGAACTTGAGTGCGGGAGAGGCAAGCAGAACTGTATG","TACGGAGGGAGCTAGCGTTGTTCGGAATTACTGGGCGTAAAGAGTACGTAGGCGGTGATTCAAGTCAGAGGTGAAAGCCTGGAGCTCAACTCCAGAACTGCCTTTGAAACTAGATCGCTAGAATCATGGAGAGGTTAGTGGAATTCCGAG","TACGGAGGATCCAAGCGTTATCCGGAATCATTGGGTTTAAAGGGTCCGTAGGCGGGGTATTAAGTCAGCGGTGAAAGTTTTCAGCTTAACTGAAAAATTGCCGTTGATACTGGTATTCTTGAATGATTGTGAAGTAACTAGAATATGTAG","TACAGAGGTCCCAAGCGTTGTTCGGATTCACTGGGCGTAAAGGGTGCGTAGGCGGTCGGGTAAGTCTAACGTGAAATCTCCGAGCCTAACTCGGAAACTGCGTCGGATACTATTCGGCTAGAGGAATGGAGGGGAGACTGGAATTCTCGG","TACGGAGGGTGCGAGCGTTAATCGGAATTACTGGGCGTAAAGCGCGCGTAGGCGGTTTGTTAAGTCAGCTGTGAAAGCCCCGGGCTCAACCTGGGAACTGCAGTTGATACTGGCCGACTAGAGTACGAGAGAGGGAGGTAGAATTCCATG","TACGGAGGGTGCAAGCGTTATCCGGATTCACTGGGTTTAAAGGGTGCGTAGGTGGGTTGGTAAGTCAGTGGTGAAATCTCCGAGCTTAACTTGGAAACTGCCATTGATACTATCAGTCTTGAATATTGTGGAGGTTAGCGGAATATGTCA","TACGGAGGGGGCTAGCGTTGTTCGGAATTACTGGGCGTAAAGCGCACGTAGGCGGACCAGAAAGTTGGGGGTGAAATCCCGGGGCTCAACCTCGGAACTGCCTTCAAAACTATTGGTCTGGAGTTCGAGAGAGGTGAGTGGAATTCCGAG","TACGTAGGGGGCAAGCGTTATCCGGATTTACTGGGTGTAAAGGGAGCGTAGGTGGTGCGGTAAGTCAGATGTGAAAGCCCGGGGCTCAACCCTGGGACTGCATTTGAAACTATCGGACTTGAGTGCAGGAGAGGTAAGTGGAATTCCTAG","TACGGAGGATCCGAGCGTTATCCGGATTTATTGGGTTTAAAGGGTGCGTAGGCGGCCAATTAAGTCAGGGGTGAAATACGGTGGCTCAACCATCGCAGTGCCTTTGATACTGATCGGCTTGAATCCATTTGAAGTGGGCGGAATAAGACA","TACGGAGGGTGCAAGCGTTATCCGGATTTACTGGGTTTAAAGGGTGTGTAGGCGGACTTTTAAGTCAGGGGTGAAATCTCCGAGCTCAACTCGGAAACTGCCTTTGATACTATTAGTCTTGAATTATGTTGAGGTTGGCGGAATATAACA","TACAGAGACTGCAAGCGTTACTCGGAATCACTGGGCGTAAAGGGAGCGCAGGCGGACCGATGTGTCAGGTGTGAAACCCCGGAGCTCAACTCCGGGACTGCGCCTGAAACTGTCGGTCTAGGGACTCGGAGGGGCTAGTGGAATTCCTGG","TACGGAGGGGGCTAGCGTTATTCGGAATTACTGGGCGTAAAGCGCACGTAGGCGGATTAACAAGTCAGAGGTGAAATCCCAGGGCTCAACCTTGGAACTGCCTTTGAAACTGTTAGTCTTGAGGTCGTGAGAGGTGAGTGGAATTCCGAG","TACGGAGGGAGCTAGCGTTGTTCGGAATTACTGGGCGTAAAGCGTGCGTAGGCGGTGATTCAAGTCAGAGGTGAAAGCCTGGAGCTCAACTCCAGAACGGCCTTTGAAACTAGATCGCTAGAATTATGGAGAGGTAAGTGGAATTCCGAG","TACGGAGGATGCAAGCGTTATCCGGATTCATTGGGTTTAAAGGGTGCGTAGGCGGCTTTTTAAGTCAGTGGTGAAATCTTGCCGCTTAACGGTAAAATTGCCATTGATACTGATAAGCTTGAGTACAATTGAGGTAAGCGGAATGTGTAG","TACGGAGGATCCAAGCGTTATCCGGAATCATTGGGTTTAAAGGGTCCGTAGGCGGTTTAGTAAGTCAGTGGTGAAAGCCTATCGCTCAACGATAGAACGGCCATTGATACTGCTAGACTTGAATTACAAGGAAGTAACTAGAATATGTAG","TACGGAGGATGCGAGCGTTATCCGGATTTATTGGGTTTAAAGGGTGCGTAGGCGGATTAATAAGTCAGTGGTGAAAACCTTCAGCTTAACTGGAGACTTGCCATTGATACTGTTAGTCTTGAGTACGGTCAAGGTAGGCGGAATGTGTAA","GACGGAGGATGCAAGTGTTATCCGGAATCACTGGGCGTAAAGCGTCTGTAGGTGGTTTAATAAGTCAACTGTTAAATCTTGAGGCTCAACCTCAAAACCGCAGTCGAAACTATTAGACTAGAGTATAGTAGGGGTAAAGGGAATTTCCAG","TACGTAGGGTGCAAGCGTTGTCCGGAATTATTGGGCGTAAAGAGCTCGTAGGCGGTTTGTCGCGTCTGCTGTGAAAATCCAAGGCTCAACCTTGGACCTGCAGTGGGTACGGGCAAGCTAGAGTGCGGTAGGGGAGATGGGAATTCCTGG","TACGTAGGTGGCAAGCGTTGTCCGGAATTATTGGGCGTAAAGCGCGCGCAGGTGGGATATTAAGTCTGGTGTTAAAGTTCGGGGCTCAACCCCGTGAAGCATTTGGAAACTGATATTCTTGAGTGCAGGAGAGGAAAGTGGAATTCCTAG","TACGGAGGGTGCAAGCGTTACTCGGAATCACTGGGCGTAAAGAGCGTGTAGGCGGGTAAATAAGTCAGAAGTGAAATCCAATAGCTTAACTATTGAACTGCTTTTGAAACTGTATACCTAGAATGTGGGAGAGGTAGATGGAATTTCTGG","TACGGAGGGTGCGAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGTAGGCGGCCTGTTAAGTCAGATGTGAAAGCCCTGGGCTTAACCTGGGAACGGCATTTGAAACTGGCAGGCTAGAGTCTAAGAGAGGGGAGTGGAATTTCAGG","TACGGAGGGTGCAAGCGTTGTTCGGAATTACTGGGCGTAAAGGGCGCGTAGGCGGTTTGATAAGTCAGATGTGAAAGCCCACGGCTTAACCGTGGAAGTGCATTTGATACTGTCAGACTTGAGTACCAGAGGGGAAAGTGGAATTCCCGG","TACGGGGGGTGCAAGCGTTACTCGGAATCACTGGGCGTAAAGGGAGCGTAGGCGTCTTGTTAAGTCTTGAGTGAAAGCCCGCAGCTCAACTGCGGAACTGCTTGGGAAACTGACAAGATTGAGTATGGAAGAGGTAGGTGGAATTTCCAG","TACGGAGGATGCAAGCGTTATCCGGATTCATTGGGTTTAAAGGGTGCGTAGGCGGCTTTTTAAGTCAGTGGTGAAATCTTGCCGCTTAACGGTAAAATTGCCATTGATACTGAAAAGCTTGAGTACATTTGAGGTAAGCGGAATGTGTAG","TACGGAGGGTGCAAGCGTTATCCGGAATCATTGGGTTTAAAGGGTCCGCAGGCGGATGTATAAGTCAGTGGTGAAAGCCTATCGCTTAACGATAGAACTGCCATTGATACTGTACGTCTTGAATTCGGTCGAAGTGGGCGGAATGTGTAG","TACGTAGGGTGCAAGCGTTGTCCGGAATTATTGGGCGTAAAGAGCTCGTAGGCGGTTTGTCGCGTCTGCTGTGAAAACCTGAGGCTCAACCTCAGACCTGCAGTGGGTACGGGCAAGCTAGAGTGCGGTAGGGGAGATGGGAATTCCTGG","TACGGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGTAGGCGGCTCGTTAAGTCAGATGTGAAAGCCCTGGGCTCAACCTGGGAACGGCATTTGAAACTGGCGAGCTAGAGTTTAGGAGAGGAGAGTGGAATTTCAGG","TACGGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGTAGGCGGCTTTTTAAGTCAGATGTGAAAGCCCTGGGCTTAACCTGGGAACTGCATTTGATACTGGAAGGCTAGAGTTTAGTAGAGGGGAGTGGAATTTCAGG","TACGTAGGGTGCGAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGCAGGCGGTTTTGTAAGACAGGCGTGAAATCCCCGGGCTCAACCTGGGAACTGCGTTTGTGACTGCAAGGCTAGAGTATGGCAGAGGGGGGTGGAATTCCACG","TACGGAGGATCCGAGCGTTATCCGGATTTATTGGGTTTAAAGGGAGCGTAGGTGGACATATAAGTCAGTTGTGAAAGTTTGCGGCTCAACCGTAAAATTGCAGTTGATACTGTATGTCTTGAGTGTACAAGAGGTGGGCGGAATTCGTGG","TACGAAGGGGGCTAGCGTTGTTCGGAATGACTGGGCGTAAAGGGTGCGTAGGCGGTAGAATACGTCTGGTGTGAAAGTCTTGGGCTTAACCTGAGGATTGCACTGGATACGGTTTTGCTAGAGTGTAAGAGGGGAAGATGGAATTGCGGG","TACGGAGGGTGCAAGCGTTATCCGGATTTACTGGGTTTAAAGGGTGTGTAGGCGGGTCTTTAAGTCAGTGGTGAAATCTCCGAGCTCAACTTGGAAACTGCCATTGATACTATTGATCTTGAATTCTGTTGAGGTTGGCGGAATATGTCA","TACGGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGTAGGCGGCTCGTTAAGTCAGATGTGAAAGCCCTGGGCTCAACCTGGGAACTGCATTTGAAACTGGCGAGCTAGAGTTTGAGAGAGGTAAGTGGAATTTCAGG","TACGTAGGGTGCAAGCGTTGTCCGGAATTATTGGGCGTAAAGAGCTCGTAGGCGGTTTGTCGCGTCTGCTGTGAAAATCCGAGGCTCAACCTCGGACCTGCAGTGGGTACGGGCAGACTAGAGTGTGGTAGGGGAGATTGGAACTCCTGG","TACGGAGGGTGCAAGCGTTACTCGGAATCACTGGGCGTAAAGAGCGTGTAGGCGGATATATAAGTCAGAAGTGAAATCCAATAGCTTAACTATTGAACTGCTTTTGAAACTGTATATCTAGAATGTGGGAGAGGTAGATGGAATTTCTGG","TACGGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGTAGGCGGTTTGCTAAGTCAGATGTGAAAGCCCTGGGCTTAACCTGGGAACTGCATTTGAAACTGGTAGACTAGAGTTGAGTAGAGGGGAGTGGAATTTCAGG","TACGGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGTAGGTGGTTTGTTAAGTTAGATGTGAAAGCCCTGGGCTCAACCTGGGAACGGCATTTAAAACTGGCAGACTAGAGTTTAATAGAGGGGAGTGGAATTTCAGG","GACGGAGGATGCAAGTGTTATCCGGAATCACTGGGCGTAAAGCGTCTGTAGGTGGTCAAATAAGTCAACTGTTAAATCTTGAGGCTCAACCTCAAAATCGCAGTCGAAACTATTCGACTAGAGTATAGTAGGGGTAAAGGGAATTTCCAG","TACGGAGGATGCAAGCGTTATCCGGATTCATTGGGTTTAAAGGGTGCGCAGGCGGAGTGATAAGTCAGTGGTGAAAGCCTACAGCTTAACTGTAGAACTGCCATTGATACTGTCATTCTTGAGTATTGTTGAGGTAGGCGGAATGTGTCA","TACGGAGGATGCAAGCGTTATCCGGATTCATTGGGTTTAAAGGGTGCGTAGGCGGCTCTTTAAGTCAGTGGTGAAATCCTGCCGCTTAACGGTAGAATTGCCATTGATACTGAAGAGCTTGAGTACAGTTGAGGTAGGCGGAATGTGTAG","TACGGAGGATCCAAGCGTTATCCGGATTTATTGGGTTTAAAGGGTGCGTAGGCGGACCTTTAAGTCAGCGGTGAAAGTTCCCGGCTCAACCGGGGAATTGCCGTTGAAACTATTGGTCTTGAGTGTAGATGAGGTGGGCGGAATTCGTAG","TACGGAGGGTGCAAGCGTTATCCGGATTTATTGGGTTTAAAGGGTGCGTAGGCGGTAAAATAAGTCAGTGGTGAAAAGCTGCAGCTCAACTGTAGTCCTGCCATTGAAACTGTTTTACTTGAGTAACCATGAGGTAGGCGGAATGTGTAG","TACGGAGGGTGCGAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGTAGGCGGTTCGTTAAGTCAGATGTGAAAGCCCTGGGCTCAACCTGGGAACTGCATTTGATACTGGCGAACTAGAGTTGAGTAGAGGAGAGTGGAATTTCAGG","TACGGAGGGTGCAAGCGTTACTCGGAATCACTGGGCGTAAAGGGTGCGTAGGCTGGCTTTTAAGTCAGATGTGAAATCCAATGGCTTAACCATTGAACTGCATTTGAAACTGAGAGCCTAGAGTTCAGAAGGGGCAGATGGAATTAGTGG","TACGGAGGGTGCAAGCGTTACTCGGAATCACTGGGCGTAAAGGGTGCGTAGGCTGGCTTCTAAGTCAGATGTGAAATCCAATGGCTTAACCATTGAACTGCATTTGAAACTGGGAGCCTAGAGTTCAGAAGGGGCAGATGGAATTAGTGG","TACGTAGGGTGCGAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGCAGGCGGTTTGATAAGACAGGCGTGAAATCCCCGGGCTCAACCTGGGAACTGCGTTTGTGACTGTCTCACTAGAGTACGGCAGAGGGGGGTGGAATTCCACG","TACGAAGGGGGCAAGCGTTATTCGGAATGACTGGGCGTAAAGGGCGTGTAGGTGGATTTGTGCGTCTGGTGTGAAAGTCCTGGGCTTAACCTAGGGATTGCACTGGATACGGCAAGTCTAGAGCGTGAGAGGGGAAAACGGAATTGCGGG","TACGGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGTAGGCGGTTATTTAAGTCAGATGTGAAAGCCCCGGGCTTAACCTGGGAACTGCATTTGATACTGGGTAACTCGAGTTTAGTAGAGGGGAGTGGAATTTCAGG","TACGTAGGGTGCGAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGCAGGCGGTTGTGCAAGACAGATGTGAAATCCCCGGGCTCAACCTGGGAACTGCATTTGTGACTGCACGACTAGAGTACGGCAGAGGGGGGTAGAATTCCACG","TACGGAGGGTGCGAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGTAGGCGGTTCGTTAAGTCAGATGTGAAAGCCCTGGGCTCAACCTGGGAACTGCATTTGAAACTGGCGGACTAGAGTTTAGTAGAGGGGAGTGGAATTTCAGG","TACGGAGGATCCAAGCGTTATCCGGAATCATTGGGTTTAAAGGGTCCGTAGGCGGCTTTATAAGTCAGTGGTGAAATCTCCCCGCTCAACGGGGAAACGGCCATTGATACTGTAAGGCTTGAATTATTAGGAAGTAACTAGAATATGTAG","TACGAGAGGGGCTAGCGTTATCCGGAATAATTGGGCGTAAAGTGTTCGTAGGTTGTAACTAAAATTATTTGTTAAAAGTTAAGATTATACTTATTAAAGCACATAATAATTTTTACTAGAGTATGGGGGAGGGTAGTAGAATTTTATACA","TACGTAGGGTGCGAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGCAGGCGGTTTTGTAAGTCAGATGTGAAATCCCCGGGCTCAACCTGGGAACTGCATTTGAGACTGCAAGGCTAGAGTGTGGCAGAGGGGGGTGGAATTCCACG","TACGGAGGATCCAAGCGTTATCCGGATTTATTGGGTTTAAAGGGTGCGTAGGCGGACCTTTAAGTCAGTGGTGAAAGTTTGCGGCTCAACCGTAAAATTGCCATTGAAACTGAAGGTCTTGAGTGTAAATAAGGTAGGCGGAATGTGTTG","TACGGAGGGTGCAAGCGTTACTCGGAATCACTGGGCGTAAAGGGTGCGTAGGCTGGCTTCTAAGTCAGATGTGAAATCCAATGGCTCAACCATTGAACTGCATTTGAAACTGGGAGCCTAGAGTTCAGAAGGGGCAGATGGAATTAGTGG","TACGGAGGGGGCTAGCGTTATTCGGAATTACTGGGCGTAAAGCGCACGTAGGCGGATTAGAAAGTCAGAGGTGAAATCCCAGGGCTCAACCTTGGAACTGCCTTTGAAACTCCTAGTCTTGAGGTCGAGAGAGGTGAGTGGAATTCCGAG","TACGGAGGGTGCGAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGTAGGTGGTTTGCTAAGTCAGATGTGAAAGCCCCGGGCTTAACCTGGGAACTGCATTTGAAACTGGTAGACTAGAGTTGAGTAGAGGGGAGTGGAATTTCAGG","TACGGAGGGTGCAAGCGTTACTCGGAATCACTGGGCGTAAAGGACGCGTAGGCGGGTTGGTAAGTCAGATGTGAAATCCTACAGCTTAACTGTAGAACTGCATTTGAAACTACCGACCTAGAGTATGGGAGGGGGAGATGGAATTAGTGG","TACGGAGGGTGCAAGCGTTGTCCGGATTTATTGGGTTTAAAGGGTGCGTAGGCGGTTTATTAAGTCAGTGGTGAAAGACGGTCGCTCAACGATTGCAGTGCCATTGATACTGGTAGACTTGAGTGAGATTGAGGTAGCTGGAATGGATAG","TACGTAGGGTGCAAGCGTTGTCCGGAATTATTGGGCGTAAAGAGCTCGTAGGCGGTTTGTCGCGTCTGCTGTGAAATCCCGAGGCTCAACCTCGGGTCTGCAGTGGGTACGGGCAAACTAGAGTGTGGTAGGGGAGATTGGAACTCCTGG","TACGTAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGCAGGCGGTTATGTAAGTCAGATGTGAAATCCCCGGGCTCAACCTGGGAATGGCATTTGAGACTGCATGGCTAGAGTGTGTCAGAGGGGGGTAGAATTCCACG","TACGGAGGGTGCAAGCGTTGTCCGGATTTATTGGGTTTAAAGGGTGCGTAGGCGGTTTATTAAGTCAGTGGTGAAAGACGGTCGCTCAACGATTGCAGTGCCATTGATACTGGTAGACTTGAGTGGGATTGAGGTAGCTGGAATGGATAG","TACAGAGGGTGCAAGCGTTAATCGGATTTACTGGGCGTAAAGCGCGCGTAGGTGGCCAATTAAGTCAAATGTGAAATCCCCGAGCTTAACTTGGGAATTGCATTCGATACTGGTTGGCTAGAGTATGGGAGAGGATGGTAGAATTCCAGG","TACGTAGGGTGCGAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGCAGGCGGTGATGTAAGACAGATGTGAAATCCCCGGGCTCAACCTGGGACCTGCATTTGTGACTGCATCGCTAGAGTACGGTAGAGGGGGATGGAATTCCGCG","TACGGAGGGTGCGAGCGTTAATCGGAATTACTGGGCGTAAAGAGTGCGTAGGCGGTTATTTAAGTCAGATGTGAAAGCCCCGGGCTCAACCTGGGAACGGCATTTGATACTGGGTAACTAGAGTTTGGGAGAGGTAAGTGGAATTTCAGG","GACGAGGGATCCTAGCGTTGTTCGGAATTATTGGGCGTAAAGCGGGTGTAGGCGGATCTATAAGTCAGGTGTGAAATCCCAGGGCTCAACCCTGGAAGTGCACTTGATACTGTAGATCTTGAGTGTGGTAGAGGTTACTGGAATTCCTGG","TACGGAGGGAGCTAGCGTTGTTCGGAATTACTGGGCGTAAAGCGCACGTAGGCGGCTATTCAAGTCAGAGGTGAAAGCCCGGGGCTCAACCCCGGAACTGCCTTTGAAACTAGGTAGCTAGAATCTTGGAGAGGTCAGTGGAATTCCGAG","TACGGAGGGTGCAAGCGTTACTCGGAATCACTGGGCGTAAAGAGCGTGTAGGCGGGTATATAAGTCAGAAGTGAAATCCAATAGCTTAACTATTGAACTGCTTTTGAAACTGTATACCTAGAATGTGGGAGAGGTAGATGGAATTTCTGG","TACGGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGAGTGCGTAGGCGGCTCGTTAAGTCAGATGTGAAAGCCCTGGGCTCAACCTGGGAACTGCATTTGAAACTGGCGAGCTAGAGTTGAGTAGAGGTAAGTGGAATTTCAGG","TACGGGGGGTGCAAGCGTTGTTCGGAATTATTGGGCGTAAAGCGCGTGTAGGCGGTCTGATTAGTCTGATGTGAAAGCCCTGGGCTCAACCCAGGAAGTGCATTGGATACTGTCAGACTTGAATACGGGAGAGGGTAGTGGAATTCCTAG","TACGTAGGGTGCGAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGCAGGCGGTTTTGTAAGTCAGATGTGAAATCCCCGAGCTCAACTTGGGAACTGCGTTTGAAACTACAAGACTAGAATATGTCAGAGGGGGGTAGAATTCCACG","TACGGAGGATCCAAGCGTTATCCGGAATCATTGGGTTTAAAGGGTCCGTAGGCGGTTTAATAAGTCAGTGGTGAAATCTGGTCGCTCAACGATCAAACGGCCATTGATACTGTTAGACTTGAATTATAAGGAAGTAACTAGAATATGTAG","TACGGAGGGTGCGAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGTAGGCGGTTCGTTAAGTCAGATGTGAAAGCCCCGGGCTTAACCTGGGAACTGCATTTGATACTGGCGAACTAGAGTTTAAGAGAGGGGAGTGGAATTTCAGG","TACGGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGTAGGCGGTTGTTTAAGTCAGATGTGAAAGCCCTGGGCTTAACCTGGGAACTGCATTTGATACTGGGCAACTAGAGTTTAGTAGAGGGGAGTGGAATTTCAGG","GACGAAGGATGCAAGCGTTATCCGGATTCATTGGGTTTAAAGGGAGCGTAGGCGGCCTTATAAGTCAGTGGTGAAATCTCCTCGCTTAACGAGGAAATTGCCATTGATACTGTAGGGCTTGAGTACAGTTGCCGTTGGCGGAATATGACA","TACGGAGGATCCAAGCGTTATCCGGAATCATTGGGTTTAAAGGGTCCGTAGGCGGTCTTATAAGTCAGTGGTGAAATCTCCCCGCTCAACGGGGAAACGGCCATTGATACTGTAGGACTTGAATTATTAGGAAGTAACTAGAATATGTAG","TACGGAGGGTGCAAGCGTTATCCGGATTTACTGGGTTTAAAGGGTGCGTAGGCGGACCATTAAGTCAGATGTGAAAGCCCCGAGCTTAACTTGGGAACTGCGTTTGATACTGGTGGTCTTGAATTAGATAGAAGTGGGCGGAATAATTCA","TACGGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGTAGGCGGTTTGTTAAGTTAGATGTGAAAGCCCTGGGCTCAACCTGGGAACGGCATTTAAAACTGGCAGACTAGAGTTTAGTAGAGGGGAGTGGAATTTCAGG","TACGTAGGGTGCAAGCGTTGTCCGGAATTATTGGGCGTAAAGAGCTCGTAGGCGGTTTGTCGCGTCTGCTGTGAAAATCCGAGGCTCAACCTCGGACTTGCAGTGGGTACGGGCAGACTAGAGTGCAGTAGGGGAGAAGGGAATTCCTGG","TACGAAGGGTGCTAGCGTTGTTCGGAATTATTGGGCGTAAAGAGCGCGTAGGCGGTCTCTTAAGTTGGAAGTGAAAGCCCATGGCTTAACCATGGAATTGCTTTCAAAACTGGGAGACTAGAGAATGGTAGAGGGTAGTGGAATTCCTGG","TACGTAGGGTGCGAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGCAGGCGGTCTTGCAAGACAGGTGTGAAATCCCCGGGCTTAACCTGGGAACTGCACTTGTGACTGCAAGGCTGGAGTACGGCAGAGGGGGATGGAATTCCGCG","TACGGAGGGTGCAAGCGTTATCCGGATTCACTGGGTTTAAAGGGTGCGTAGGCGGGTAGGTAAGTCAGTGGTGAAATCCTGGAGCTCAACTCCAGAACTGCCATTGATACTATCTATCTTGAATATTGTGGAGGTAAGCGGAATATGTCA","TACGTAGGGTGCAAGCGTTGTCCGGAATTATTGGGCGTAAAGAGCTCGTAGGCGGTTTGTCGCGTCTGCTGTGAAATCCCGAGGCTCAACCTCGGGCCTGCAGTGGGTACGGGCAAACTAGAGTGTGGTAGGGGAGATTGGAACTCCTGG","TACGTAGGGTGCGAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGCAGGCGGTTTTGTAAGTCAGATGTGAAATCCCCGAGCTCAACTTGGGAACTGCGTTTGAAACTACAAGGCTAGAGTATGGTAGAGGGGGGTAGAATTCCACG","TACGGAGGGAGCTAGCGTTGTTCGGAATTACTGGGCGTAAAGCGCACGTAGGCGGTTACTCAAGTCAGAGGTGAAAGCCCGGGGCTCAACCCCGGAACTGCCTTTGAAACTAGGTGACTGGAATCTTGGAGAGGCGAGTGGAATTCCGAG","TACGTAGGGTGCGAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGCAGGCGGTTATACAAGACAGGCGTGAAATCCCCGGGCTTAACCTGGGAATGGCGCCTGTGACTGTATAGCTAGAGTGTGTCAGAGGGGGGTAGAATTCCACG","TACGTAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGCAGGCGGTTATATAAGACAGATGTGAAATCCCCGGGCTCAACCTGGGAACTGCATTTGTGACTGTATAGCTGGAGTGCGGCAGAGGGGGATGGAATTCCGCG"];
      var samples = ["MVB2015-6547","MVB2015-6256","MVB2015-6254","MVB2015-6544","MVB2015-6545","MVB2015-6548","MVB2015-6255","MVB2015-6258","MVB2015-6257","MVB2015-6546","MVB2015-6518","MVB2015-6528","MVB2015-6539","MVB2015-6237","MVB2015-6532","MVB2015-6535","MVB2015-6542","MVB2015-6249","MVB2015-6227","MVB2015-6223","MVB2015-6529","MVB2015-6226","MVB2015-6533","MVB2015-6522","MVB2015-6232","MVB2015-6238","MVB2015-6233","MVB2015-6252","MVB2015-6229","MVB2015-6509","MVB2015-6244","MVB2015-6219","MVB2015-6513","MVB2015-6236","MVB2015-6235","MVB2015-6514","MVB2015-6519","MVB2015-6536","MVB2015-6510","MVB2015-6300","MVB2015-6289","MVB2015-6561","MVB2015-6570","MVB2015-6589","MVB2015-6581","MVB2015-6294","MVB2015-6578","MVB2015-6582","MVB2015-6274","MVB2015-6586","MVB2015-6574","MVB2015-6286","MVB2015-6266","MVB2015-6552","MVB2015-6579","MVB2015-6293","MVB2015-6501","MVB2015-6267","MVB2015-6556","MVB2015-6585","MVB2015-6590","MVB2015-6575","MVB2015-6276","MVB2015-6263","MVB2015-6595","MVB2015-6594","MVB2015-6262","MVB2015-6261","MVB2015-6593","MVB2015-6592","MVB2015-6260","MVB2015-6591","MVB2015-6515","MVB2015-6234","MVB2015-6511","MVB2015-6512","MVB2015-6530","MVB2015-6524","MVB2015-6243","MVB2015-6508","MVB2015-6228","MVB2015-6538","MVB2015-6534","MVB2015-6531","MVB2015-6239","MVB2015-6517","MVB2015-6516","MVB2015-6520","MVB2015-6220","MVB2015-6523","MVB2015-6221","MVB2015-6247","MVB2015-6251","MVB2015-6526","MVB2015-6537","MVB2015-6242","MVB2015-6225","MVB2015-6527","MVB2015-6269","MVB2015-6291","MVB2015-6580","MVB2015-6299","MVB2015-6587","MVB2015-6560","MVB2015-6502","MVB2015-6551","MVB2015-6283","MVB2015-6576","MVB2015-6555","MVB2015-6583","MVB2015-6277","MVB2015-6563","MVB2015-6564","MVB2015-6588","MVB2015-6567","MVB2015-6554","MVB2015-6568","MVB2015-6577","MVB2015-6559"];
      var vlines = ["10.0","39.0","63.0","72.0","98.0"];
      var xtick_pos = ["5.0","24.5","51.0","67.5","85.0","108.5"];
      var xtick_labels = ["P","P>P","P>S","S","S>P","S>S"];
      var field_name = "Experimental.Cat";
      var title_text = "Skin diff. abundant P vs. S";
      //***********************************************************

      var yaxiswidth = 100;
      var xaxisheight = 20;

      // set the title
      $('#field_name').html(field_name);
      $('#title_text').html(title_text);

      var svg = d3.select('svg');

      var width = $('#div-heatmap').width();
      var height = $('#div-heatmap').height();

      // available display for the heatmap (without axes)
      var hwidth = width - yaxiswidth;
      var hheight = height - xaxisheight;

      svg.attr('width', width)
          .attr('height', height);

      svg.on('click', onclick);

      var xScale = d3.scaleLinear()
          .domain([0, width])
          .range([0, width]);

      var yScale = d3.scaleLinear()
          .domain([0, ids.length])
          .range([0.5, hheight + 0.5]);

      var heatmapregion = svg
          .append('svg')
          .attr('width', width - yaxiswidth + 'px')
          .attr('height', height - xaxisheight + 'px')
          .attr('x', yaxiswidth)
          .attr('y', 0);

      var heatmap = heatmapregion.append('g')
          .append('image')
          .attr('class', 'pixel')
          .attr('width', samples.length)
          .attr('height', ids.length)
          .attr('xlink:xlink:href', 'data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAHcAAABxCAYAAADvYDyXAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAuIwAALiMBeKU/dgAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDIuMS4yLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvNQv5yAAAIABJREFUeJztnXd4HNXV/z8z29SLJXdbsiW5ybJsuXdcsYHYAVNjWigmr0Mx7Mo2NjbGBdmSdoeEN4QUEhIgjbwhCXlDaKZjDLZx772Am7pkbZ/7%2B2OYbdpVcYX3%2BZ3nOY%2B0s7N37tx2zvmec8%2BVht9uF1/8oRiA/PkK5npBQ3dIPgwNWRLubh5Stptxp0PqQUFjB4n0Az5qexgxuAU1/VUsZwzsW26lv03BUiOoGOUjbbMJc4PgzDgf5jNGVANk7BBseLmYYf95HM/r7fGmSOwqtQIwcVIJfouB00NNyD5wpwmMTol9T1nptdJB4lfgTZIQMjR2VsnYJrHpRRvZL5eQsCsOgxvq%2BviQG2XUBBVTjQFvhg/8EpJbpvs7Kl9dZcBcI2GpgZqhbg5P%2Bw35z/8YSzUMuH0Hm14vAAn8g%2BpRDyWhGgU9/tfDoRvMpPWsxvNpBqYGSDztxxsvU1kIh4ttjHxrAdWfdMLgAb8JXB399F2ym31P5pO5GdzpMglnVE5e68V40kz3dz00djRxarwKJpWEA2Ya8zxITgOyW8Ifr9LtXYmKQgOoIIwCdwc/lnZO2J2MP07gS/WT2OEcsqzScCwFDIAfMnOrqNmaiT9BYGzoJjN6VjnODJmajgJ/nITfImjsLGGpguQhdRjeb4ervURDVwlhgPouRjxpkPgVJHRpoFFNYsKU1Rwq8OA9Zga/hOmc4FxnicSMRs6pCRjqjGx4WRtEyRY3tS5wdgSAovsd%2BL/yoRolPKmCxK8kAFydfQC4O/gx1xpxdhAAyD6Js8P9ZI1bg3BKeBMFjZ0F7btX4/YaUYWEOJKGr4sfVAlDjYG6bCP%2BFC9eYcTZ1c%2BAnK/o/98/RhbgyoA6TzyWakF9D8jJqGb/mQRkl4SzgxnSPSRZPBzv5SF5t5nKAgOZW/3kDTmB6SmFnim7OJPUEY9RIPklRIIff99s1Ewv3iQzAJ5ECeqN%2BOO0d6jrIdO952nO1iUh%2B80ggaFRRjVr39fkGnB10t5fcsvISV46p9dxpH08xnoDXXtUkGjyUNGYgMEl42vnJTurghSLC/8ACafbjKzPnM2/tpGxDfautJLz90b2rrQSX6Hi/CSTlENOUvfBnhIrPV6rYNtzVhJPCDp8dJbdNyyn3XYZU52H5B1m9i2zknjEyKbf2Ug8KVA3pdJ%2BnZHDxTZ0GtbuKAAdN3i1Z79g46P/LCT%2Bna1kbINur3%2BNpUYi8YgRgLhTRjqtO0fHDSrd3/FwaL6NpENGUraZMdQZSTkEGVslKg5kUH88hYbTSexebUWqMNP5DRMGD2z7mZVjDywkY5vg2NwFHHg3hz0lVnavtpK2T6VjfB2d/3OCtL1w4t0sEo8ZSN8pkbq9ksQdcXx6dTkJh8yk7/Wxb5mVda/N52hlO/Y9ZWXdhr603yxI2y1hcEOHj0x8fVUyyVstbPmFjW3/bcWbJJF80IC5RuaDdxex52krFR91xmBQ2VVqJXWLmbgzEnGnZTp9LLOrzErCUSOSW8ZSKZOwNZ6vP%2B9C%2B88NpByE2rWdOLyhO3W7Mkg%2BBAmHzJx9vwsH3s6hbmcGmS8nIGX9okwkHjUi%2BeHcABfyWTOGbo14aizICT4Sktw0Hk3B0NGJt8aCFO/n6N2LyP3zStQTCQwetY9tX3eh3WuJ1N5cj29XCgmF1dRUJYLTwLiiPVS5E9l3qj3tX0vAkyRRP70B9UAS3kwfvR/YQOV9ozB4IK7az1ezPbR7Ox7DrWdodJtxbU8jc9hpzm7pSFzfGrxeI16Pke4dqgD4uioVr8tIersGhnY8jtNvIjehgj/vG0LH1Hrq3WZ8fgOuHWlkjTrBweMdyO1%2Bhv5pJ3n/leE4OwhUI9wy5VNefXcMlpw6bsrbwh93DiMluRHf2kzSr/2arOQqdlZ0ovpwOsIo6PUHDwdvjiPpqEzpg79h7kd3YojzIcsqZrMfdXMqiSMqqNmVoc0%2BP6jZTiTAcCAeSZUYNm0HOys6UfVVGmmd6zjXaMHvl4mL96BuTaXnxCNUORNItripaEjkxp5b%2BN32UXTMqOVURSrWwe%2BytqIvFc4kRrQ/Qo03gQlpe/jn2UEkGj1IgNBn1PhrSmlsb8TcoOJsJ2N0CTa8Usyom8tJ%2Bfgwb536OUPvdrDx9zZGzyrHUu3lyAwznT8RrHttPgMeUTCdE3z5Gxu9Vij0/FsVNf3TOHWVyrEfLQjM3KIHHGz%2BVXAmh9KY68uIO%2BvmxMRE9q7SVpWiOQ4Szvpp6GzA4IYvf2tj5C3lrH91PkPuceBqJ%2BHKFJgaJMx14DeDP057M9kHSNBul49zHQ0gQ3V/gaVSZu8KK6NvLGfd3%2BYz7A47G14ppt8ihXN5Ho7d9zi5axwcfFyrZ065A1O9RPbr1bjbJ/DhO4sCde75x6fJ%2BbnAbzHQ2NGE7If1fylm6N0OGjtKxFUKEs76qepnJO6swFKv8tlf59NnicLeVVYKHlNwZQrMNRINvbx0%2BsCA0S2o7mXAUiPwxUmoZu299q6ykr9Aod1uH8dv8ZHxvgVnR4nG7n6kVA%2BWOC%2Bew8nQ1Qn58xXxTQcHOO9pR9jn/sWKGD99TeBzwaPabyZOLBGA6OmwNyljyA8dTa5FctEch/jBZ/eLPkub1iGUs35ZJiaPXhl2Lbc0WP7ge5s%2Ba9TN5S0%2BHxCD73OIR7%2B8RQy7wy5y/7JCXPPhw6J4y00i79UVAhBrdk4TA%2BaF1%2B/RL28Rv9ozVgBi4I8dIuuXZSL7uXKR9csyjV8oFTeve0As3DJLPLltprjuo4fEkm3fD3ufMW/PD3xeuf26wP/3b7gzrFz9eYDIfqlEDJ9tFy/uHam1u90h%2Bj6hiOyXS8TcjbeLrN%2Bt1n471yHyFypCKnxQEdueszLyVjvJ%2B%2Bs5PSqV%2BlyVpKMy3kQQMnTc5MWZacBnkUg97OGDtYsofFAh4ayfikKZDl%2BqrHttPpPGreJc1zgausoAZO7wcHS6EckvEX9aYle5NhMHPKKQeMqPMEiY6/w0dDay%2BQUbuaUOMrYKvIkS57pIeNqpHJlXzMC5DjypEuZagZAlVIu2zPnitfoZG8GTDqpJYHBKuHq5SNgdhzdRYGyUSD6uohokKgYL4s7IqBZtKT64yEbhwwqqEXY8Y2XwfdpznO0FqolAnbN/Vo6pTkb2SKTvUanuJ7NvmZUx15fR0MVAdaGfY/%2B1gJxyBwYXSKrEvmVWej%2BlYK4BX4Kmr/S0O/Cn%2BujwsZG4Gj8nRxkweCRkNwgjSD7wxws8qYLkIzKJJ1XODta0Z2ODjJzbwP6bl5G/QCGuQuC7vpra6kQyPjJTMdyP7JIxdGpEHEnE19GDLAwwelY5pno/FYNTUM0g%2BTRt1ZMmcHb3ca6TkdpcGWdHCW%2ByAYCkk378ZglvlpszQ7XOPHxDHLU5Mq4OAk8qVPU1I4wCZIE3RTDgEQUAMbma2lwDZ2a6SNz6FZtf0Ja%2Bgwtt1PSS8aRIuDNUULVlr6EHJJ1QOdcVfIngyhTU91RxtVdxtxMYXQJPioo3RcXV2Y/R7MeVIfC2U/GkCU6PVTG6BKR7Atqqt52fyWNXIfkFCadV%2Bv9zKb44icaOArWHE3OtRGNXlX6PK5jqZDwZfoRBkLqnlqSjghE/sFN7Tz1bf24jvn0jg%2B91IPnAlyBQjdozLNUQX6GSckRl7MwyZC/I5wyoRvAky/i6uXFn%2BjE1gCdNRTWDagJhUUk56ufUGIGQBcZzMn6LVmbWL8vwpAp8iRIdkhqQqk00dpLA4ocMNxaLD0kFySCQJT%2Bse20%2BH7%2BxkMqRmuote2H7T61IAjplV%2BJNlJB8YHTC6WFa59bkGqjtJYMUlJfGcxIJpwXeTK/WqYAwC8zZDViqJLY/a2XUzeV4tqRjcELihgTePPFs4PeTx6zEm6JicGkvaKnUBo0vUeVcZxlhAGEA2S0h0r2Ya2StwTygxqmQ7EMYVdJSGlHjVIQsMLgh6ZARVzsJqcJM8jHwJgm69zzL2k%2BWIPnhiz8WYzH6MboEapxAllXc7VTMNTLxZwS%2BeIEp1Y0nXeXo99LxxUskHXdRdyoZgPSkRmr6QPxZCTVe4I8XDLvTTkO2yoZXimnsIFPdy0j8GYl22yR88RINXWXiEjzg18xL1Qi%2BRIGlSgKziidRRnbJ33wnUJP9yLLAUG/A4JZwtgeL0Yea4EcYQGo0kpLipFNKPd50P6LRiOxJhWF32gFIOKQBCAa3RP5CBUulRO0nHTGdEySdEMRVCtL2aR3hS4IOG32IRmOgc%2BLOSnhSJUwVJjztfRhcWgd7jiYha1YPn/11PpZKSPraj%2BTTFCid3O0spO2WiK9USd9iwFILfRcrGOtljE5QLQKDUxtkRosPX4JmE7syJYwNBmgwIjcaqDjYDtkjkfVvrcFkD2RubURN91LfA2jvxrwmHYB2u5yMnVHGl9eVYHRqipZQZTK3SMgeqO8hYaqXMW1PpNtaQcoRFaNTUJsTT9IhI0PvctAxoZ74MxL1g1x0/EQi6aiMpVYTbX0XK6gmSN/vw5UhqBwk8MfDrjIr/j3JxJ3VOrDj52Cu1hTDxH1mMj47hejkwuCWMLglzKeNuBosGNwaSGJww4naVIw1wfb3%2BAwcPp2BKd2FKdWNvKfEGgAX9pRY2fbfVgxOsFQKzHUC2Q/tPzqJN1nC4BZs/L22hO5bZsUXL5GyR0OfdNqhWDHXSBybs5AO66sx1hqQvBJJX/uZOLFEm%2BEugTdRpuu/TvDpPxZQdL9DW8aq3LjbSSQddxJfqdLYWbCnxErCSYnO71eQsl%2Bi02f12r2bEjm4yIYvHsx1grgKiS4fgLFBIu6sgcPWYup6GDlsLUY1gzfFTMYnZjpsVDEdjsPZ3sy4a0upyo%2BnJk9rIHeqROoBFfV0HOYGlT0lVvY/qfGep63UdzGy4ZViZB9sfMnGrlIrG1%2Byse14NzJ2eWn3kQVXhrbafPL6AiSf1qad1jfyyesLkH0SRx8pZqdd0z3iz0gYXLDTbqWmt4yxETpsEqgGeGt/Oeb98cgebaWKPyNhtPg48ISNDp9JpBxW8azL4NACGwYXGM7JJL6egmlvAubNSfhPxyMThXaVW9n8gg1fnITxHLx50E6nT2r4/M/FYfetf3U%2BO56x0m6n9nn7s9bAd1OHLuPtras4tMDGoYU21r02n/ffXxz4ftOLNt48rMlgXeau/XQpnb5wsvbTpTgzNAVGL7cxO5Wtz9uo6p9E2kE/8thqQJNRzkwJX4JWbqfP/exdYaX/P5diaghYeZjqPLi/V8u61%2Bazf6mNmlyZj99YSPJxH6722n1pBzx88cdiunwsaMwMb5r8hQpuzWRl40vhZtzh2U/w0X8WsvkFG3GVKpYaEajbsDvsgftSD6r0fUIJ%2B63Bo/2V3WDwCL6e6kcYYehdDvYtt5K2T7BvudauvrNxAGx4pRhXhszu1dr1XWVWDs23sel3NixV4BzgJPmQDH2faGqGjJ7V1IwYP32NGHp3y%2BZNKF89cIkAROFD0U2dgkcVUfhg82YQIIbdqZlaukky%2BsZyMeSettUFEGOuL2tybcJaqxjyxiLN1HjWLrKeLwt8BkTWL5r%2BZszb88WMjx4MfJ44qUQUPKaIovsdYsKU1SLvaYfoaXeIIW8sElm/KhXZL5eI29ffG7i/z9%2BeCphagMj9S/D//AVN2yP796sDZtuAR5RAWX0Xa/eOnVkmej%2BlhJmfvZcrgrY2UFt5%2BOymNrDO03taW1XGsDvtYlr/xQIIG2C6va1zqG2r/z/y1uDzi%2B5vOiAmjVvV5FrRAw5R%2BLAS1X6OxoN%2B5BCTxzYtZ/SNWh3GXVsa9XcD5zrCytDrG9pm%2BuTTvw/lHj9p2rZFc7T7ckodwpi/UAl4ZvosUYivEPjiJXY8E1xiJ04q4f33FjPiNjvxZ718sHYReU87yNyq8vUUlYyNxgDi1Hu5QtwZ2PaclcH3OqjJkuhpd4RhywBD7nFQ5RFwmCbXfXHgt0js%2BIlWB3eqzNHvZ9LzHgeewxJFDziozwa/Jn7ptULBdA445Cd/voJvRD116w0UPqxQF6/dM3pWOWdytL8nrlXp8o6B9X8ppqZ3PMO72/nij5rIySl1UBUvOPqIjd5PhS%2BhY24ow5luQBgJQ9gasiDlmInChxS2/cwaQPGqe2vKSMVAE7wRLGfUzeU0Zsq4MjSxU/igwpbnrIy8pZyqfjL7nrJSYFWo6%2BdlzxwrWS%2BUsuV%2BG/3%2BvgxpfSoGl2bNjBi%2BF8MaB0lHoW68E/PuBKo6%2BenxUzv%2BNA9yY2c18NBB1%2B6m8J4deNLCG9yVYWLUzeWcHgWWU1qLxlVInLnBDQRftO9ihZHTt7PtOStFDzioLhB0%2BcSNuU5i9KzysDI3vWjDb5KIpE0v2hh532b833TK2BlltLvhBENm7uBwsY2awR42/8rGgSdsnOupmW6Ggloa%2Bnqo7m1gV7kVz4lEdtqtmBoEu8o0eO/EVA3gqLu7juQ9JioGSIy7thTLLacx3H0mIBvNdRKkaYJQt1cBsl/WlMGKMV68SVq9%2ByzROt%2BbLHCnah05Ycpq3Gna9wateQhtYwBXmkxNvoq5HvJWOdj2nJUB8xTWvzofNb8BgP437SbhsIlhd9qRGwz0eVIh48VEnIMaqe%2BhMny2nY3Hsjj4uI268U7kI/HEDatETvOgmlWoN2rY8uhZ5ZzrJLP158HRWHS/A2HUNNHU1zbTOH0gn/5jAa2hfouUgLAfPtvOuS4yqkmzR1OO%2Bfnsr/PD7h8wT6HLO2dRDx2D/Dze%2BXJ54LeuDBlfAoHVBaDAqjBu9ibe%2B%2BcQLNVQM8SDKd5L2psJCBkqRviZUrST3w7/Pb1WOjA1aH7jm9c9wKaP%2B3BooY3CBxW2PaeVmf2snaOPFFP4oIKzI7Tf6qeqj4E9JVam5S/i4B2ZHFhsY/KYlaz9dCkAk8eu4uDNcWRuktj4ko0Rt9kDCmfRHAcdXt3JmZv7B5TFiRNLODk6DmcXP0cf1N5/4FwH7nSJPSVW8p52IKkwaPJe/jr6V2HtM%2Bi/HKQe9tL4aA2V29rjT1JJ3WNg239bA%2B2ddEJlw8vF5P5lBT3bV/HupJ8AMWQcEIYnx%2BKhd7Usl8Z9L1zmFD3QdmUoknutUMJk6OD7gv/rmOzYGU2VIdCwciBMTur4%2BNgZZVHlZyhH0yOa%2B820XvObLa815QNiwCNK4N0BkfW71QG9oNdKR%2BDd%2Bj2uiOyfl4ugBYw2Ww0ecH4jC5yZRormOGi/sRZXxwTcaUb8FomNv7cx7E47G14u5lwXifwFCl0/qOedL5YBkFvq4OBCG1dNW8PJUWaqGqCwhyaPgICJMu66Uj7%2B98LQKjB8tp3ko06OT0kk8WvB5l/bmDixhMaOZmS/wJ0s40uQMB0WbHrRRv58BdkLX/7ESr/HFYQBnD4/A%2Bc6%2BOR5GwWPKRhcgsxtjRyemcChhdpMyl%2BgsLbMyrhrS/n4jYUcthUzdmYZjZkGTkyOY2iuA9WgeaAAeq10YKnU9ID4s96wOueuduD9yBe4TzVBu50Cn0Vi8ws2Gntlwn4oeEzBXCuCZa5QiKuE1MM%2BKgqMyF4wnRN4vym%2B4DGF%2BAoVb6LEll/YaOihctXU1Xz4pKbPVBld1OVobfbFUhuFDym44zRPWMpeTUwERsbUwcvE1OHLAxpXc6zP7lg8deiyFsu4alr0lWHymJWxfzNVMwsmTXi61TMhtK6FDykB0yzabBv0Xw5R9IBDTBq3Kqa2PHZmcEUosIZr7M1ZB7p2PGXE8qjfj7wl3ASdOjz8vtDVKfA%2BDytiyojlYvw1wdVx6F2aV4hYFYnkq4uebNPScr48dbA2KGLZsXrnNse6/RfZqNE4lpmiNxygN1SzHA0b0DmauQU0cSUO/LFWT31yRYqVAY8oYe%2Bfu9oRc0A16dzQ3m8tN9dw58sjbguv7LT8IKig26%2BhMnfUTeEN2%2BdJpcngiPVu464tDWucsTPKAvZpNL560NImMy8WEBOrUyN54qSSqNcj/dy6zNU5%2B2fBeuoyt88SReStCrz7xe2YtrIOTsTivosV0WulQ4y5vkwM%2Bt/we/WX7/Nk08aNNuhGvrVAAKL3stgzsblltSVRFMqxlt6W3jX084gf2MOe22eJEnXlilyue/w0UM%2BmldaXhWF3aNebk4GhrKMobYUpm%2BNYGm807vOkIvJKHGLcdcFZGktu5pQ5Ymqx0SBACEfEpucWi4H/ekIUWBWR97RDjLjN3kT%2Bhg6w0NUnMNhuaT5aRBcL%2BqwM5V4rFNFniRK4Z9iddjHue6Wi91NKYCAQOdUvRycEGqiV8KMui2I1zOB7HU0aNprMjgY/hmLreascgSVNbzQ9lCisnBimXKg4GX1jeWB5z13jCBtkE6aEz75QBS0ULi14TGlSRwiHIvV6xuCLM8MuJUcb9efDrVGMQjvnQp%2BnO05ay5FYOYSvqtG0ZdA09hgi48p33reFQ1ex1nauDuK0pIxGWwGicWucFdGcCAWPKdGCEq98ozbHQ%2B5xBCqtI0v69WY7at7FETeXkyNnrq5Q6azrArouFG0wRIjZK/9SLXGoHGoNR9OeW8vnoztcss5%2BLPw9IkOO%2By0K/z508H%2BzhF/5l2gtR85GfaTrGHjoshQtbllXqFqa9S0oKZeUoymPzfHgex1i8H2OMJmri4qoYTbfNhp/TSkA9TkqA%2Bc6Atfd7bS/Z4u0zVabfhf0aulhMiNvDYa5%2BBIleip2ano3/zzd2wIwdmZZM3defDK4Yn%2BXW6q9e2jozpe/tfHlb2x4koLuU1emFuD4nehcg8sPaIHoyV9p//dbpLD/Sa0TQgP0dDJ%2B00jr/xKM%2B0o56iPxuMzBRdG3skSjT16P7ubUB9zFJt2pEI0sld/sfswIdlvhw5pPuT4neJ83gUBMWdg0jwSrL4RbC7%2B1xKHhJOeD/ETyrevmXLR3HHqXI6ap1lZTKJL7LI1u4ugKVe/litC3A%2BkgRsS9l16OtJWjIWKRe4Wa49YE3bXUYVe6DVpVz7sdAf1ABzqGz7aH1v/KV/Jy8aUyj0KB/2jYdFsAkdYG5UU%2BK3SGD5zr0CM9r3yjt8TT8he16GAI5Wgzd/KYlYEIhlihtufTGZeDB/3XNy7AmeFmWqQpBOHm0Heic5vj84lfjsWh8jwaCnS5OJopFgpcQKvt8SvfQW1p9AtVqIoecIQNiGhK35W0c5vjlpw8OnjznZK5Om57uSDFb0vntmZ25s9XmizXELLjYPSs8mbDTSAYZjNhcsthLkCYT1XnSBgxVgzVpeTmwmGicSwzJzT%2BKpZ2faGm0EXglm8K1QbHXF8mxtzQfOhoLI6GEU%2BRbtL%2BjlrRprK%2BTTxxUomYnlsc%2BBxtorQVH7/knRvqpWhNDHOkEtLSyJ3e0xo2e1sb8XE5OZZiFS1yMlowwBXl1kQTtsT6UqcL/NAwG90W05NxxOJYjuhvE7clhgpatywPv/2SzmhEtIw2Y64va6J%2BB7674fzdYrGUFX3p10NbQ7mlbDffBf7WLcuRDQ%2BaQhWr01vDocu7HkMVqgVH69zvOl8sjP28O7ctIysyxLS1PC1/kcgp05bfUHk%2BYJ4SM3b3u856uOoVnbnNPbw1uw0iQ0Jaw1dNWxNQWPouVsT03OLvzMwNhTD1ganDm9G4LZjxRe/caBwZv9tcPHI0s2hah7nNPnx6T2sYZjx2RlnU1AahfKEIVVuVorbcHxqCOi1/0bchZEf7JxoIHYujqfyt8QMP%2BpEjLMD66oFLmjgEWurc7wpPGbE8TFuOhiJdts5tiaOZKs0pVs0NFj2oe8qoFWF27vhrSqOiPc3FLV9Mx0E0bkvQvr4sj7u2VIy/plSMnaFZHFcQztT%2BiZS5zRnkkabQ0LscrW7k0GUudMfB/1WFSufISMbL1rnR9uMW3e8Qw%2B6wR3U%2BX4gppPsmo9nW8H/TFLpSLAPEV6oUzQlGFYIWKRhf4SMaOTMvPK5Oz%2BCq07T0%2BwAC%2BTD%2BP104BXrJlxCeWcaTAhWF5kAKn1Dyx7Wu8KsHLmlyTU/P04Q6d2hdod9R0lMjXm5q83SPtixPz3q0ybVIbLXgMSUsWFz/XpfvU%2BNuv%2BJLWWs52v7faOE7eltdociO5m8Y8IgGLoQqQvoe0Ejub2vqONBZdy7oGc5j7U09n9393wZuKQNOYABcRM25FbBm04s97VHMnhjGfMFjihg9q1xkvdD2ThkwTxHZz2rl6qZWNDtX3yEXqpGfjwl0PpEc5wMbjru2VOSucXx7QIxIB3NbTCFoHfw4dmZZYJCEYstF9zu%2Bc6ZQa2eqzv0ev/ymkHzV1NUAfPxGeD4oPfNZNKrsZ4z5XTQa8kMHo2eVU9vDiDtN0%2BF2/MTKlFErAs9ytTO1qcwrTdW946NeHz7bHva54FFtu0fqYTXa7ZecxOhZ5U2WnzHXl8WMvrgQf27ojJ1qui0wc7%2Brsra1fLGyA7SRz6OD/rn0vB42dmZZIGhaTxI2vdsjotcKRUxLv09MHrPyO4MtRxuMUXNuLA7u5bncdQzYub2Xh6efBS2hZDRK/V1y1OuxqO9ireyqvka6rq0BoLZnHCNvKefNE8%2BSdEzwVvVvWPvp0lYnD73S1NC5qWja/IKtCRgkf4MDVfeLYd9fQgp07r5l1iZfbvlFdLkbd9rd5Nqom8qj3KmRL0kA4OwYlDu%2BOGjoqu29bOysvfjVRU%2B2ps7fCqoqFFGvV%2BeHX2/I1XrXkxkd7bvUFHNa6ziwbrDHilnWQXE9W0yonatHXmS9qMnvUBBjyqgVAZdfrEx0oSZPtN3ykSbR%2BZofBY9GD%2B6O5aobepe2o13XgiOz3kG4HXpFIzGiJdaKljpHZ93ZEOrtaAmFiXzB0TeWhwWvTx6z8pKGh7YlVZHO0SIoWhMxOmXE8jB35hXz57Y1Cl//zchbygP%2B10hn/ZAfOqKO5lCe3tPaxL79tilU0VIMRXau3nF6os1uvmCOAAAXWUlEQVRvEZ9f50Zqf61ZDkfeag8gUSNvKQ%2BLxNBNhe%2Byyy/aYNax5dbmobqorI/CaHhwS37blnIXRtvnGpYR7V5H2EwdO6PskkdWtJWj2aex4rhCUxRG/i5U7F2M1A%2Bt5G86qg0CP1qnx5q5RXMcYdlIdeB85C3lgY7ttUL5zu0Vam1qBV1v6fXX5U1yOF5qNoJ29ElVhDu16H4Hzg7a4QqRdGaaB14JvxZ/2tnkPtCOS9dp7MwyjhVqOd7Xvxo8xCKuEs4OSoTPohYRRmNnlsXMMHM5KfJUsFgUyCqzP4k9Tzdty0tJMkD7LedIOSTCK5UYvWMBxDnNgB87I5ijST/fIJRG36jZvkN%2BqBn2FQOMxJ3QMOQh9ziYOLGEaf0Xs/2nVrY%2Bb2Nq3O1MmvB0sxW%2BmB07eeyqVt2XvzAc4GkuN1UoiDH0bgeyDyaNW0X3d5piA20l/YhanZrDFnRqMp11BUtffq8uelLbunl9mZgweXWrseXIpTqaUhEqc6fnFn/rMOZo4ipSW9Y1fn3Z1bPA6SJo3LWlYabQhCmrw6JJQ83Ji2oPR/Pdjn/XFvY5%2Bzmts2OBGIu23iBySsPLGXmrvUVnck/FLqZ98Ejg84jb7FEVKl0xC/XHNpftXOfIstpiQ8cKSGjLoLgSm8vDePjt9mZB7X6LlLCNxbE4MoV73yeUJp07dmZZGDASun3xCnlNzptbWmF0jVhvlytiCkVmGIewHPkCgsv0hMmrA7Zc0Rwt0qC5Ed5Ssq%2BJE0vCnN7jryn99m1gPk9uzfLakikZyucZThwbxIhVYLRsbs3Zp7qbb/C9juDpmLdo0OMU6SaRvzB4mkhrQYwwzPmm1jdSWwGbWJ2U9Xx0vUPH0nXWY8ZyylsetG3p7FZxSwm1mjutI5SnZz3apJGjLct65w65xxFmK07LXyQmTF7dpsOgovHFjluK5UzQB4n%2BDtNzi8OOgpmWem/Yb6Jh1Be9MyNZ1/xaWkYiozJaMwMiB87IW%2B0BTxNooa26pjj8drvo%2B4QSdeZeRkSnCV%2BIkz2WQhmpLV9C1l4g2satWF6hSFNI7%2BhYy2Nz6fimSDeJAfMUMS1/kZgad/t3GlsOZX3mRkvtd9nhx9awbpP2L1aazNzIjo2WhyqvxBEGwV01bY2Y3u0Rkb8wuLP%2BQpfly8FTRixvdjO1Hkk6adyqwATRQ3gvJ8ugwY%2B9VoaHh2Q9r6EwOeXB63oIzE67lXWvhZ%2BB%2B9n/zGfUW0H0qCYvGM2oI1TxpyRULak5OaUOLKe0g4Abcny8/95ixl9TiqHOE1Zu7urooT6xqMDaNFwoFumJqAGyXlwT9Z6BP276fG%2BKmfqeWubyrBfCk2r3L1b4%2BI2FTBmxHH%2BCMfC%2BBqdE9u9Xt7puF4NkgKSTfkz14TE%2BGZu0EJjMzYICq8KQHzqYMDm8cvr%2Bl4LHtEb6bFoQltv%2BUytXD1xCnyVKID196hFfIJwnfQ805KXi79yOjA3asz76z0L8KeZAGcNn2zm4yMaUEdrmsJyy6B09fnqwY3YozeO3%2BfMVhtyjlROa7v7YPY8H/g8dIO12uym638GwO4Mhqx%2B%2Bs4ist5yk7oNj9y8M1K3ofgeJX6sMmKdgqHdR193ErjLtGYcW2ojfZwmUEQphjrhNK1sPg20LhQ7QaBRzWutbOKfnFotJ47XlMhZKNXX48rBIjGgIVSRQcdW0NWF27sVIMtZa7f5CuS05QFqq04Um/26GtWyfkXBe9rN20XexElXRWr79e216iJ5NtPcyRQz%2Bt%2Bacz3qhNODmyytxhJ4c%2BX%2BGrx64JGAPn892mwtlGcDgBCkiID7urMyeEivGc1D4evhWzLefHM/oWUGPxOhZ5RTNcTTxUuheow5fam4%2Bf5zg3PpMQFvOnB21vaDxpyUydggg%2BsEQ%2BrI85B5H4P/mqL%2Bt7ctb6IkfEPRoxaK8VQ4GzFMCMnnUWwsCYmvctdo7vL11FYZGLcDUUNO2XRqtoUnjmnq1Ij1Hou8TTWdoXolD5C9QosKLuiNB58KHlGaXKR2hmpa/KIDYZD9rD/wmf6HyrUsPeLG2XPZ45pvjUZcql%2BSs4RZY20HQ45VwEySn1NEESpswebXo6fimsq04dStyf26Pn9hFzp80GZv98/ABUjTHIQoeU84LW9YbMNqAuhLcUnrjy9q50PqTqEbcZm%2BiAIyeVd7Ezh15a/A%2BfSDkL1CCp3fd4xCDfuQQU4c9JbKftYvht9sv%2BOj0UPQrGp/PwIkVkppb2rSsHs80zSGi27l5JcH7I0GMlqJE28r6CiHr20i8SVLgxKmCx5Sw6INhd9qZ1unHAHz%2B52KSv/YxelZ5wBTyJMlYanzklDoofFCh8EGF2tvq2facZgYYGwmYEh%2B9qZkczkyJuGqVqoJkEr%2BSSTnUiD/B1OrDmPLnN5WrW35ho/BhJbB9JZI2v2Bj9Kxy%2Bi5WmDipaRqDgMkVYtufHWhkwDwl0A46xZ%2BSGHN9GT2eCV478lhxIM3EkB86GDujLGDnxp%2BSyFvlYPC9Dt79fBlAIOrk8z9rv4lMrdB7mRL2TICrB2j6z/DZdobe7WhiCk2Yspqtz2ump9T3tWXC2WCh87/NYadn9XjGTtpeibQDHuqyzVQWqUg%2BiRHD97Lhk76YcuvxeoyoZ%2BJAQEKPOqSP09jpsAZernKgoMe/vRyZYeLIvGKyXlyDVG%2Bkx7%2B8fD3OgjdZpXvBKY6eyCRjnYm4m05zdlNHDiwOxidd99FDbD/UFdNpM95ML13fNPDZX%2BeTU%2BbAn6hy9MH55L26gozXEvj8z8VMGbGcI99PIqmwEvWtzIAtOz23mN3zOpFwUqbz1OO8N%2BkZQLMT9XvKd17N/P5vAzD1/Xm8M/GnDHhEYfuz4bbzn/YP4YCrE0sH/Juhdzmoy5XYt8xKnycVhAzdxh9HRvDVO1kkjT9DRU0SqcmN1G/P4OAiGyU7rqFRNfOfZ8aTdMLDsXtUDs9%2BgoE/dlDTT%2BXow%2BEAkU56XSastfLBZK1TB9/rwJskUTvIQ/ZrEjU5JrY/a9UmZ3NeIT0c8%2BqiJ8Wg/3KE2bh9nlRE0QOOZqMAI82r3NXBAwUDLr5hTwW%2Bzytx/J/Blr8NLANhZk0o6ejK25tXsOUXNj5Yuyiw82/vCiuVI72BKMARP7A3%2BX363nD7ylIt4fzmHLrGTtqydvzqFIrud5C72oGIsRFuWv4ipvVfHPjckplyMSlWMFw08VH4UHCJLHhUYfjtWpv0WxS%2BdBbNcTD4Pq0d9XsuFWkzaGhwxoyeVd5s/ghdMQkNHRk7oyyQ8ARiOA6edoSZPLrjoOj%2B4NaTWI6Dthwadal57MyyMGRNd3pMmLw6LKHJ1QOXiIJHFTGt1/wrkjYh0LnNacs6LDjm%2BjIx4jZ7AGVqiYfe7QjTHgf%2B2BE4dLHPEiWQHrDPUkWMuE3Tlq%2BALXjpBsGMsoBoC/WGXa5EKDJAnycVtv48PMh6wDyFIW8sYsAjCms/Xcqk8U/z6T8W4LdIfHldSUCL6/2UwtC7ogP6BrcIS1KmGiU6fyq0/81QPbILU4c9BYCpUaWiKJXUI8F9rC2B4peCQmOxAfo93rQOA%2Bc6As6SUMopddBvkRJAqAB8w%2BsZd20p3mRBT0Vrs0/%2BdeGx15H1DD1XOJQERM//GC3345jrywJnDkSOwMj9RpHf914WTDI2cK5DTBm1QkzvpoW2TstfJMZfU3rJk3G1NYYqWtTilBHLA/tzY/1Od5LocWiRkS6XY0unlFfiEB02qlT2N5B8VLDxJZtmZsQJRIKf1G0mkk76kb2CxkzNNVeTL%2Bj8iQj4dEfPKmfda/PptdLB/qU2ht7toD5bQvZA8jGVqgKJA4tt5P55JT63kaN3L6LHT%2BzEndGUK2cXP4ZGGWEQHLYFZ3rRHAd1OZB8BLb8MriyjL6xnHV/C5oLw%2B6wI91xli%2BmlzJ2RhnHb/KTtN3CTrumEA67007GulO8edDO6FnlnJiukvm5kS9/Eywzf4FC1qvHEb/zc/yNHphrBbIX6vIg%2BRAY3dqKs%2BHlYrJ/Xk63vDOc3tCJuEqJHYqVgXMd1Ix2I3wyHT4wIakCn0WicqwHvDIdu1VTvak9RqeE0QmqEbxJsP9JK72XKRgbm%2BbD1Ou%2B4eVgm%2BhtHWrC6VT4kMK2n2nXckodUPSAQ4yeVR6W5DqUh8%2B2i7EzysTVRU%2BKEbfZA7Oz8EGl2c3ZEIyk18NsBt/rELlrwp%2BjZ2%2BdMmqFGHxvU8izrRy50lxoBH%2B0fMtjZ5YFzorXdZVQXUF/pg6/Tus1/7Jtvg5dgeXNv7Kx7rX5dPoses6GL/5YzCf/WsC57CQ%2B/3MxrgyJYXfYSTrpJ75CDcjbaAlTdE%2BTPppAm4WgyYh%2BixSMTm3TGXyDkv25Lmo9WkuRiUhDgZnzoUgAAyDutBPZB1/%2BxhbQVTK3axvhhs%2B2s/4vGphSU5BGbqkDb6dUqvoGvUKRni3dWX8xKHTjXSDhSWSSMZ10G00PsdmhWKkaILHutflseKWYjS/ZKHrAQcJJEXC1FT6o0PsphfZfNlI0x0GPn9rJ%2Bu0aKkb78CZpxqw3SaKxm58u/zhC5RgvZwcl0mHTuUBKXj1a4mLR9NwL62SAMTdoSsy7ny%2BjcroLIDC4vckmJqy1cmqin6F3axDjF38oxphXz3sfL6H7tUcCSo8OP4bSpbB35aIHmjbihLXfyKo77CQfVen/z6Vc8%2BHD9F2s0GepwsGFNno8YyfrV6VkvVCK65o6hAw7HVZG3GZn23NWDG7wJxhxZUoIo%2BDYvY9z7P6F7LRbGT7bzq5yK1OHb%2BPwvT1I2mMmrlpw6CEpkIGtsZMU0JYjd9lFAzFG3GZn1M3lYRnc%2Bi7W/K0Fjym8edBOrxUhIEMUbTcUsNBDbXo/pQTCbHSdA%2BDw7CeA4FbOU8NNnHm7G8fmLKSuh0TfJxQmjVvF3hufYvSN5bw14Vn8cdo79S9WyC11MPIW7T38ZonaXJneTzWtk26VDPrReQz2q6auFlm/Lo158kg0bXnYHdr%2Boryng78Z8QN7wDM09G5HmFcItPDZvouVgJHfZ0nQB9xnqebPLXxYEdM7P9isTGnt8XS6Vt6WI19CvTU6LBtLZkfbQdBrhdLEW5T1QqmYNG6VyCl1RE2FP/x2%2ByWTx9JVU1cLb7IxLJqx/z%2BXsvP7KwOfh91p58wIgeGcTFyVxK5SbWb3tylIKvjH11Iy4O/ckLct8JuiBxygap6YIT90sOl3tiYbp7//8Vx2n%2B6Eu9FEh/Z1nD7WDkODHKYxX2lqy2bvEbfZAx6e/sUKmds9fPjW4y386tKR/OE7izgzRA4LbRWfpNNnqRIIPRGyRJcPtQi%2B9L0%2Bsp/TlpOdDis7nrGS%2BPcUVpTeHV6wBzxpmnyt7a1dOznKEHCn9VukcPQPeST9J4mjdy0mqTyFru9KdH/X32Klm8OWIxNrXihVDNAUoUjXW88/BjeJj7xV%2B%2B7MMM18G3q3FgVZ1ddM7/9ZzvDZdvr9PShnJ0xZHSYCIsXOxSTR/59LRd6rwZwUo2eVi5FvLRA5f1olsl8qaXJS5K3r5oR97rtYEVOHLw9z2I%2B81R4wBXRHdX%2BbIqybbxaA%2BP7Hc0XuGoeY3u0RMXfj7YGg7W9bqqJYHLmFM3LJ1UGMrN9owQk9/7TqsufEkKe%2BP4%2Bd31%2BJpyEYL3ziOj/rp5Uhvo7j6F2LOT1KMOqtBXz/47lc8%2BHDrP%2Byd2AkZr1QirlOS5vw2f8El/aT4wW%2BZ84B4O2upQyQVPjbZ8MB2P96LxLzq9n1VFf%2BvWkgwqKS/bNychftJpKiOeZH3lIeFRq82JRX0lSRiQxgH3mrnZSj/oDClv3zcpzZaQAcu%2B9xht7t4PAPlgRyYhQ%2BHL4J4GKaQqEkf/VmNgCJ%2B4Odm3hA%2B99SKTN8tp3sf6vUvtuJr17IY/eWbDqsl/B4DOSucZB4wMS2n1mZMGU1Q%2B8OVjjrDZUjG7sBELc/jsKHFHwJIBI0e3pXuRX1vXa061RL0iEjHT41kPCVgV3PFYRVcMg9Djpu1MyOUTcHl%2BP1r85n95pLk0AkNFdG3NmmfsiEA2Ya22vL9dC7HMSf1XZJeNL9DJ9tR1j8GNx%2B8hco5C9QcKVLYQMxrlIl4etgeVX9W5/0U8%2BPPfje8EEXKTYAZGMD9PnbUzR2D8q69L1%2Bev5pFa72KpUDJRq6GMnc7uHsZDfmKllTrvYkYe5Th6uDSk6pg6PTzWz8fdCA9iYZ6Fp0EtB8v9t%2BZsXVXkWq07aZ5D3twJsEVV%2Bl4WonaOwoUTBjD2enhicG2fSiVmY0ky2UdP%2BoTnpoTDTSdYZYtPaTpqeqhJIvXgRMoI0v2ajvZsFvljBXG/jij8Ucu%2B9xDt5moNtbVXjSBK5MQafPXYHf12fLqKZgh3Z7v/XJUD58ZxEAX/423NETClHqJNeNctI1vZb4Tg2BiydmaB0tjAJ/VxdCBmOjn/R1FlxdvQizwJ2uYnovlZT9Ev5EFdkbXvD6vxRzfEcnQPM6BV6k72kAOg8/ibObj5Q9RtIKKmno5eXI871J2tL0XJv331/M5l/Z%2BOyv0cNPgDCcGLTtLLHo6IOxy4mk9ltcTa71%2BFdD2OeNL9lI33CKdruCwQld1hpozEpB8kPWW05Ojo7T8F5g92prGPL1/nuLuRQkq04jVY3xiM2pgYsZ60z4601k/9tP/M54anvDGZsL3zU1ICSkeB8Fg46QffNBzDPPIqV7KL7hn2GGdl6JA0NnJ4UPK6gD6gEYMPgwSWZtlB471Q4p0YdnTD0en4FJA3djvvM0vtHh8GP2SyX0VOxN5NLAuQ6yn9Wu9fipncIHgwMor6TpBq3JY1YG5GesTV8Q1Lb1dznyPXOTe47YJLJfDgaz5a5xsOehTpyZ6aanw06BVcF1ZxVf/cBLYlElppVnaOzhDQTe55Q5wgLr8l5dEbUurQEusn4dO6BQNp81kvDb9JC02mC56TTmCiPOTCO7V1vxJfmR3kvH82U6aduNUGciyejm6F9zcb7dAemUhZ%2B8cn2Y58Z4TkKSBX4LsFtLvm02%2BPiq9ptBVGdCOA2o%2B5Jw7UzjvS35DM48TtbTIqyCpmMWLBVywH7USTVLHH1Eu3ZkXjF1o4NJzvw9XIENWjqt/XRpWOBdLNKxaf1dUvc1lYfes/GaPvoNHXzcRuo%2BCfOeePxpmk5RXZ1E1u8NeD7K5NDZDABqc7VGNjolpI7Bpdh/PCFqXULbMxYdmxMdNgaQPRl%2B0h89ilQYnDGnK1MZMmEPNb1lRr61AEuFgU7Xa/fUDPKSP%2BAY6w/25FwXgTcRpl%2B1GWdW%2BLrsThcIVWKn3Yq74zcv7E6gZ3oVAL%2BY/lvSO9fhTVNJHVTB81N%2Bj9NvYu%2BPw1809SBRk51FLrtHbn8i8L8ODUajYXfaw3b0tUTu9KadK3kl0j4L7tgbfJ%2BDrc/b8MULOq01skOxErc/jqq%2BZhq7qrhr4zBWG4k/rY2IDht9GA8GxU/yoQs/Pi8aSc/tvkoMiz%2BMSVKZO38e61%2BdT8mOa9h3riP1Pgsbducwo2gLFtnH5JRddDLU8dvKsXw//UtcwsRnDb3415ECpmfv5t3nR1GfA%2BYaCXlkNfaC/2Hey3O48YaPWT3w73x0OId36wt45a2rGDJmL9kJVSTIHvaf68DMzM2oQkaWVH7Qa1Oggq/uH8zLJ0fhmZvKsZmZdH2vniG/3Mq%2Bhg7sOduR3Tcsp88ShaHf28EfRv6Wwfc6GDx3Cx8c7oXfZwh09ITJqzkx2cyBxTby//Eku64PXwqH3WFnwyvF9HRoIb2bf2Vj8L0OCn60g%2B2/LmDzCzYmj1nJ2k%2BXsnDLLA41ZrLnL33xxUNjfxeDehynwpnE8RMZjOp7kJmZW1ix/ToGdznBqLSDvHxkBLWfdyDpmKB8yS%2BJk7w8suIhDB7BdY9/wLIB/xuoS/9iJeCLDqXB9znI/KKaM6PT2fJLG6NuKg8zP0NpwDyF/wcZoe7Gb2v4DwAAAABJRU5ErkJggg%3D%3D')

      var xyratio = get_xyratio();

      var scalex = 1;
      var scaley = 1;

      var xAxis = d3.axisBottom(xScale)
          .tickValues(xtick_pos)
          .tickFormat(function(d, i) {return xtick_labels[i];});

      function customTickFunction(d) {
        var dom = yAxis.scale().domain();
        if ((dom[1] - dom[0]) < 50) {
          return Math.round(dom[1] - dom[0]);
        }
        return 50;
      }

      var yAxis = d3.axisLeft(yScale)
          .ticks(50)
          .tickFormat(function(d) {
            try {
              var taxa = yticklabels[Math.round(d)].replace(/;+$/, '').split(';');
              var label = taxa.pop();
              while (label.length == 3 && label.substring(1,3) == '__') {
                label = taxa.pop()
              }
              if (taxa.length > 0) {
                 label = taxa.pop() + ' ' + label;
              }
            }
            catch(err) {
              label=''
            }
            return label;
          });
      yAxis.ticks(customTickFunction());

      var gY = svg.append('g')
          .attr('class', 'axis axis--y')
          .attr('transform', 'translate(' + yaxiswidth + ',0)')
          .call(yAxis);

      var gX = svg.append('g')
          .attr('class', 'axis axis--x')
          .attr('transform', 'translate(' + yaxiswidth + ',' + (hheight) + ')')
          .call(xAxis);

      // The per sample-type vlines
      var vline_lines = heatmapregion.append('g');
      for (idx=0;idx<vlines.length; idx++) {
        vline_lines.append('line')
            .attr('id', 'vline')
            .attr('class', 'vLine')
            .style('stroke', 'white')
            // .style('stroke-dasharray', '1,1')
            .style('stroke-opacity', 1)
            .style('stroke-width', 6 * xyratio)
            .attr('x1', vlines[idx]).attr('y1', 0)
            .attr('x2', vlines[idx]).attr('y2', ids.length);
      }

      // The cursor crosshair
      var focus = heatmapregion.append('g');

      var xline = focus.append('line')
          .attr('id', 'focusLineX')
          .attr('class', 'focusLine')
          .style('stroke', 'white')
          // .style('stroke-dasharray', '1,1')
          .style('stroke-opacity', 0.5)
          .style('stroke-width', 1);

      focus.append('line')
          .attr('id', 'focusLineY')
          .attr('class', 'focusLine')
          .style('stroke', 'white')
          .style("stroke-opacity", 0.5)
          // .style('stroke-dasharray', '1,1')
          .style('stroke-width', 1 * xyratio);

      d3.select('#reset')
          .on('click', resetted);

      d3.select('#zoomsplus')
          .on('click', zoomX);

      d3.select('#zoomsminus')
          .on('click', unzoomX);

      d3.select('#zoomfplus')
          .on('click', zoomY);

      d3.select('#zoomfminus')
          .on('click', unzoomY);

      d3.select('#movedown')
          .on('click', moveDown);

      d3.select('#moveup')
          .on('click', moveUp);

      d3.select('#moveright')
          .on('click', moveRight);

      d3.select('#moveleft')
          .on('click', moveLeft);

      var initial_scale_factor = hwidth / samples.length;

      var shiftdown = 0;
      var current_tx, current_scale_x, current_scale_y, current_ty;
      d3.select('body').on('keydown', onkeydown);
      d3.select('body').on('keyup', onkey);

      var zoom = d3.zoom()
          .scaleExtent([initial_scale_factor, 10000])
          .translateExtent([[0, 0], [width / initial_scale_factor, 100000000]])
          .on('zoom', zoomed);

      heatmapregion.call(zoom);

      // and initial zoom to have full screen
      resetted();

      function onkeydown() {
        if (d3.event.key == '-') {
          unzoomY();
          return;
        };
        if (d3.event.key == '=') {
          zoomY();
          return;
        };
        if (d3.event.key == '+') {
          zoomX();
          return;
        };
        if (d3.event.key == '_') {
          unzoomX();
          return;
        };
        if (d3.event.key == 'ArrowDown') {
          moveDown();
          return;
        };
        if (d3.event.key == 'ArrowUp') {
          moveUp();
          return;
        };
        if (d3.event.key == 'ArrowLeft') {
          moveLeft();
          return;
        };
        if (d3.event.key == 'ArrowRight') {
          moveRight();
          return;
        };
        // and now process the shift
        onkey();
      }

      function onkey() {
        shiftdown = d3.event.shiftKey;
        if (shiftdown) {
          xyratio = xyratio * current_scale_y / current_scale_x;
          current_scale_y = current_scale_x;
          current_tx = current_tx / (current_scale_x);
        } else {
          xyratio = xyratio * current_scale_y / current_scale_x;
          current_ty = current_ty / current_scale_x;
        }
      }

      function zoomed() {
        tt = d3.event.transform
        // if shift pressed we're in x-axis zoom/move mode
        if (shiftdown != 0) {
          current_tx = tt.x;
          current_scale_x = tt.k;
          gX.call(xAxis.scale(d3.event.transform.rescaleX(xScale)));
          vline_lines.selectAll('#vline').style('stroke-width', 3 / tt.k);
          focus.selectAll('#focusLineY').style('stroke-width', 2 / tt.k);
        };
        // if no shift pressed - we're in y-axis move/zoom mode
        if (shiftdown != 1) {
          current_ty = tt.y;
          current_scale_y = tt.k;
          ytransform = d3.zoomIdentity.translate(tt.x, tt.y).scale(tt.k * xyratio);

          // for the y-axis we need to update the scale since it's already scaled by ids/hheight
          ytransform2 = d3.zoomIdentity.translate(tt.x, tt.y).scale(tt.k * xyratio * ids.length / hheight);
          gY.call(yAxis.scale(ytransform2.rescaleY(yScale)).ticks(customTickFunction()));

          focus.selectAll('#focusLineX').style('stroke-width', 2 / (xyratio * tt.k));
        };
        newt = 'translate(' + current_tx + ',' + current_ty + ') scale(' + current_scale_x + ',' + current_scale_y * xyratio + ')';
        heatmap.attr('transform', newt);
        vline_lines.attr('transform', newt);
        focus.attr('transform', newt);
      }

      function reset_coords() {
        xyratio = get_xyratio();
        current_tx = 0;
        current_scale_x = initial_scale_factor;
        current_ty = 0;
        current_scale_y = initial_scale_factor;
      }

      function resetted() {
        console.log('reset coordinates');
        reset_coords();
        old_shiftdown = shiftdown;
        shiftdown = 2;
        heatmapregion.call(zoom.transform, d3.zoomIdentity.scale(initial_scale_factor));
        shiftdown = old_shiftdown;
        // The nice transition didn't work with the shift up/down
        // heatmapregion.transition()
        //     .duration(750)
        //     .call(zoom.transform, d3.zoomIdentity.scale(initial_scale_factor));
      }

      function zoomX() {
        old_shiftdown = shiftdown;
        shiftdown = 1;
        ctrans = d3.zoomTransform(heatmapregion.node());
        ctrans.x = 0;
        ctrans.k = ctrans.k * 2;
        // the leftmost feature showing in the screen
        screen_start = xAxis.scale().invert(0);

        // move so 0th sample is left column displaying
        heatmapregion.call(zoom.transform, ctrans);

        zoom.translateBy(heatmapregion, 0, 0);
        zoom.scaleBy(heatmapregion,1);
        newpos = xAxis.scale()(screen_start);
        newpos = -newpos;
        ctrans.x = newpos;
        heatmapregion.call(zoom.transform, ctrans);
        shiftdown = old_shiftdown;
      }

      function unzoomX() {
        old_shiftdown = shiftdown;
        shiftdown = 1;
        ctrans = d3.zoomTransform(heatmapregion.node());
        ctrans.x = 0;
        ctrans.k = ctrans.k / 2
        // the topmost feature showing in the screen
        screen_start = xAxis.scale().invert(0);

        // move so 0th feature is top row displaying
        // zoom.translateBy(heatmapregion, 0, -tozero/xyratio)
        heatmapregion.call(zoom.transform, ctrans);

        zoom.translateBy(heatmapregion, 0, 0);
        zoom.scaleBy(heatmapregion,1);
        newpos = xAxis.scale()(screen_start);
        newpos = -newpos;
        ctrans.x = newpos;
        heatmapregion.call(zoom.transform, ctrans);
        shiftdown = old_shiftdown;
      }

      function zoomY() {
        ctrans = d3.zoomTransform(heatmapregion.node());
        ctrans.y = 0;
        // the topmost feature showing in the screen
        screen_start = yAxis.scale().invert(0);

        // move so 0th feature is top row displaying
        // zoom.translateBy(heatmapregion, 0, -tozero/xyratio)
        heatmapregion.call(zoom.transform, ctrans);

        xyratio = xyratio * 2;
        zoom.translateBy(heatmapregion, 0, 0);
        newpos = yAxis.scale()(screen_start);
        newpos = -newpos;
        ctrans.y = newpos;
        heatmapregion.call(zoom.transform, ctrans);
      }

      function unzoomY() {
        ctrans = d3.zoomTransform(heatmapregion.node());
        ctrans.y = 0;
        // the topmost feature showing in the screen
        screen_start = yAxis.scale().invert(0);

        // move so 0th feature is top row displaying
        // zoom.translateBy(heatmapregion, 0, -tozero/xyratio)
        heatmapregion.call(zoom.transform, ctrans);

        xyratio = xyratio / 2;
        zoom.translateBy(heatmapregion, 0, 0);
        newpos = yAxis.scale()(screen_start);
        newpos = -newpos;
        ctrans.y = newpos;
        heatmapregion.call(zoom.transform, ctrans);
      }

      function moveDown() {
        screen_start = yAxis.scale().invert(0);
        screen_end = yAxis.scale().invert(height - xaxisheight);
        old_shiftdown = shiftdown
        shiftdown = 0;
        zoom.translateBy(heatmapregion, 0, (screen_start - screen_end) * xyratio);
        shiftdown = old_shiftdown;
      }

      function moveUp() {
        screen_start = yAxis.scale().invert(0);
        screen_end = yAxis.scale().invert(height - xaxisheight);
        old_shiftdown = shiftdown
        shiftdown = 0;
        zoom.translateBy(heatmapregion, 0, (screen_end - screen_start) * xyratio);
        shiftdown = old_shiftdown;
      }
      function moveLeft() {
        screen_start = xAxis.scale().invert(0);
        screen_end = xAxis.scale().invert(width - xaxisheight);
        old_shiftdown = shiftdown
        shiftdown = 1;
        zoom.translateBy(heatmapregion, (screen_end - screen_start), 0);
        shiftdown = old_shiftdown;
      }
      function moveRight() {
        screen_start = xAxis.scale().invert(0);
        screen_end = xAxis.scale().invert(width - xaxisheight);
        old_shiftdown = shiftdown
        shiftdown = 1;
        zoom.translateBy(heatmapregion, (screen_start - screen_end), 0);
        shiftdown = old_shiftdown;
      }

      function onclick() {
        var pos = d3.mouse(heatmap.node());
        // var cx = Math.round(xScale.invert(pos[0])), cy = Math.round(yScale.invert(pos[1]));
        var cx = Math.round(pos[0]-0.5), cy = Math.round(pos[1]-0.5);
        // var posx = xScale.invert(pos[0]), posy = yScale.invert(pos[1]);
        var posx = pos[0], posy = pos[1];
        focus.select('#focusLineY')
            .attr('x1', Math.round(posx + 0.5) - 0.5).attr('y1', 0)
            .attr('x2', Math.round(posx + 0.5) - 0.5).attr('y2', ids.length);
        focus.select('#focusLineX')
            .attr('x1', 0).attr('y1', Math.round(posy-0.5) + 0.5)
            .attr('x2', samples.length).attr('y2', Math.round(posy-0.5) + 0.5);

        var cid = ids[cy];
        var csamp = samples[cx];
        try {
          var ctax = yticklabels[cy].split(';').map(function(e) {
            try {
              e = e.split('_').pop()
            } catch(err) {
              console.log('failed to split taxonomy on "_":');
              console.log(e)
              console.log(err)
            }
            return '<a href="https://en.wikipedia.org/wiki/' + e + '" target="_blank">' + e + '</a>'
          }).join('; ');
        } catch (err) {
          console.log('error when parsing taxonomy:');
          console.log(err);
          ctax = "No taxonomy in biom table";
        }
        $('#taxonomy').html(ctax);
        $('#sampleid').html(csamp);
        $('#sequence').html(cid);
        // Get dbBact annotations for selection
        $.ajax({
          url: 'http://api.dbbact.org/sequences/get_string_annotations',
          type: 'POST',
          data: JSON.stringify({'sequence': cid}),
          dataType: 'json',
          contentType: 'application/json; charset=utf-8',
          success: function(data) {
              if (data.annotations.length == 0) {
                atext = 'No annotations found for sequence'
              }
              else {
                var atext = '';
                var clink = 'http://dbbact.org/sequence_annotations/' + cid;
                var ctext = '<p><a href="' + clink + '" target="_blank">dbBact Summary</a></p>';
                atext += ctext;
                for (i = 0; i < data.annotations.length; i++) {
                    clink = 'http://dbbact.org/annotation_info/' + data.annotations[i].annotationid.toString();
                    ctext = '<a href="' + clink + '" target="_blank">' + data.annotations[i].annotation_string + '</a><br>';
                    atext += ctext;
                }
              }
              $('#p-annotation').html(atext);
          }
        });
      }

      function get_xyratio() {
        return (hheight / ids.length) * (samples.length / hwidth);
      }

      $(window).on('resize', function(){
        $('body').height('calc(100vh - 50px)');
      });
    });
  </script>
</head>
<body style="height: calc(100vh - 50px); min-height: 600px; min-width: 1080px;">
  <div>&nbsp;</div>
  <div id="div-annotation" class="panel panel-default" style="float: right; margin: 10px; width: 360px; height: auto; white-space: nowrap;">
    <!--Here goes the annotations!-->
    <div class="panel-heading">
      <b>dbBact annotations</b>
    </div>
    <div class="panel-body" style="overflow: auto;">
      <p id="p-annotation">Click on heatmap to see annotations</p>
    </div>
    <div class="panel-footer">
      For more analysis options, download <a href='https://github.com/amnona/calour' target='_blank'>Calour</a>.
    </div>
  </div>

  <div class="panel panel-default" style="margin: 10px; width: auto; height: 100%; overflow: hidden;">
    <div id="div-title" class="panel-heading">
      <b><span id="title_text">Experiment</span></b>
      (sorted by field: <b><span id='field_name'> NA </span></b>)
      <span style="float: right;">
        <button id="reset" class="btn btn-default btn-xs">Reset</button>
        <button id="zoomfplus" class="btn btn-default btn-xs">F+</button>
        <button id="zoomfminus" class="btn btn-default btn-xs">F-</button>
        <button id="zoomsplus" class="btn btn-default btn-xs">S+</button>
        <button id="zoomsminus" class="btn btn-default btn-xs">S-</button>
        <button id="moveup" class="btn btn-default btn-xs">&uarr;</button>
        <button id="movedown" class="btn btn-default btn-xs">&darr;</button>
        <button id="moveleft" class="btn btn-default btn-xs">&larr;</button>
        <button id="moveright" class="btn btn-default btn-xs">&rarr;</button>
        <button id="btn-help" class="btn btn-default btn-xs" onclick="$('#div-help').toggle();">Help</button>
      </span>
    </div>
    <div id="div-heatmap" class="panel-body" style="height: calc(100% - 100px);">
      <svg id="heatmap" style="width: 100%; height: 100%;)"></svg>
    </div>
    <div id="div-selection" class="panel-footer">
      <!--Here goes the selection!-->
      <span style="display: inline-block; float: left; overflow: hidden;"><b>Sample:&nbsp;&nbsp;</b></span>
      <span id="sampleid" style="display: inline-block; float: left; width: 120px; overflow: auto; white-space: nowrap;">NA</span>
      <span style="display: inline-block; float: left; overflow: hidden;">&nbsp;&nbsp;<b>Taxonomy:&nbsp;&nbsp;</b></span>
      <span id="taxonomy" style="display: block; overflow: auto; white-space: nowrap;">NA</span>
      <span style="display: inline-block; float: left; overflow: hidden;"><b>Sequence:&nbsp;&nbsp;</b></span>
      <span id="sequence" style="display: block; overflow: auto; white-space: nowrap;">NA</span>
    </div>
  </div>

  <div id="div-help" class="panel panel-info" style="display: none; position: fixed; left: 50%; width: 400px; margin-left: -200px; top: 200px; box-shadow: 10px 10px 5px rgba(0,0,0,0.5);">
    <div class="panel-heading">
      Help
      <span style="float: right;"><button class="btn btn-default btn-xs" onclick="$('#div-help').hide();">&times;</button></span>
    </div>
    <div class="panel-body">
      <p>Use mouse or -/= for zooming bacteria, shift+mouse or _/+ for zooming samples, arrow keys to move in heatmap.</p>
    </div>
  </div>
</body>
</html>
