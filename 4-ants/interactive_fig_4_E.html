<!DOCTYPE html>
<meta charset="utf-8">
<html>
<head>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  <script src="http://d3js.org/d3.v4.min.js"></script>
  <style>
    .axis path {
      display: none;
    }
    .pixel {
      /* image-rendering: pixelated; */
      padding: 0px;
      margin: 0px;
      border: 0px;
        image-rendering: optimizeSpeed;             /* STOP SMOOTHING, GIVE ME SPEED  */
        image-rendering: -moz-crisp-edges;          /* Firefox                        */
        image-rendering: -o-crisp-edges;            /* Opera                          */
        image-rendering: -webkit-optimize-contrast; /* Chrome (and eventually Safari) */
        image-rendering: pixelated;                 /* Chrome */
        image-rendering: optimize-contrast;         /* CSS3 Proposed                  */
        -ms-interpolation-mode: nearest-neighbor;   /* IE8+                           */
    }
    .axis line {
      stroke-opacity: 0.3;
      shape-rendering: crispEdges;
    }
    .line {
      fill: none;
      stroke: steelblue;
      stroke-width: 2px;
    }
  </style>

  <script>
    $(document).ready(function() {

      var yticklabels = ['NA'];
      var ids = ['NA'];
      var samples = ['NA'];
      var vlines = [];
      var xtick_pos = [];
      var xtick_labels = [];
      var field_name = '';
      var title_text = 'Experiment';

      //**********************************************************
      // following variables are set by the external python program
      // DO NOT DELETE/CHANGE
      // yticklabels go here
      var ids = ["TACGTAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGCAGGCGGTTTTGTAAGACAGAGGTGAAATCCCCGGGCTCAACCTGGGAACTGCCTTTGTGACTGCAAGGCTGGAGTGCGGCAGAGGGGGATGGAATTCCGCG","TACGTAGGGTGCGAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGCAGGCGGCGCTGCAAGACAGGTGTGAAATCCCGGGGCTTAACCCCGGAACTGCATTTGTGACTGCGGTGCTAGAGTGTGGCAGAGGGGGGTGGAATTGCTCG","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCGGGGCTTAACCCCGGAACTGCCTTTGATACTGAGTGTCTTGAGTGCAGAAGAGGTAAGTGGAATTCCGGG","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCAGATATTTAAGTCAGAGGTGAAATCCCGGGGCTTAACCCCGGAACTGCCTTTGATACTGAGTGTCTTGAGTGCAGAAGAGGTAAGTGGAATTCCGGG","TACGTAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGGGTGCGTAGGCGGTTGCGCAAGACAGATGTGAAATCCCCGGGCTTAACCTGGGAATTGCATTTGTGACTGCGTGGCTAGAGTATGTCAGAGGGGGGTAGAATTCCACG","TACGAAGGGTGCAAGCGTTACTCGGAATCACTGGGCGTAAAGGGTGCGCAGGCGGTTGACCAAGTCTGATGTGAAAGCCCTGGGCTCAACCTGGGAACTGCATTGGAAACTGGTTGACTGGAGTACGGTAGAGGGTGGTGGAATTCCTGG","TACGTAGGGTGCGAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGCAGGCGGCCGCGCAAGACAGAGGTGAAATCCCTGGGCTCAACCTGGGAACTGCCTTTGTGACTGCGTGGCTGGAGTACGGCAGAGGGGGGTGGAATTTCGCG","TACGAAGGGTGCGAGCGTTAATCGGAATTACTGGGCGTAAAGCGCGCGCAGGCGGTTCGCCAAGATGGGAGTGAAAGACCTGGGCTTAACCTGGGAGGTGCTTTCATAACTGGCGGGCTAGAGTACGGTAGAGGGTGGTGGAATTTCCTG","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCGCGCAGGCGGTTCGCCAAGATGGGAGTGAAAGACCTGGGCTTAACCTGGGAGGTGCTTTCATAACTGGCGGGCTAGAGTACGGTAGAGGGTGGTGGAATTTCCTG","TACGAAGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCAGATATTTAAGTCAGAGGTGAAATCCCGGGGCTTAACCCCGGAACTGCCTTTGATACTGAGTGTCTTGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCGGGGCTTAACCCCGGAACTGCCTTGATACTGAGTGTCTTGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCGGGGCTTAACCCCGGAACTGCCTTTGATACTGAGTGTCTTGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCGGGGCTTAACCCCGGAACTGCCTTTGATACTGAGTGTCTTGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGGAGGATCCGAGCGTTATCCGGATTTATTGGGTTTAAAGGGAGCGTAGATGGATGTTTAAGTCAGTTGTGAAAGTTTGCGGCTCAACCGTAAAATTGCAGTTGATACTGGATGTCTTGAGTGCAGTTGAGGCAGGCGGAATTCGTGG","TACGGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGAGTACGTAGGTGGGTTATTAAGTCAGGTGTGAAATCCCTGAGCTTAACTTAGGAACTGCATTTGAAACTGATAATCTAGAGTTTCGTAGAGGGGGGTAGAATTCCAGG","TACAGAGACTGCGAGCGTTATTCGGATTCACTGGGCGTAAAGGGTGCGCAGGCGGTCGTGTGTGTTAGGTGTGAAAGCCCGAGGCTCAACCTCGGAACTGCGCCTAAAACTACACGACTAGAGTATTGGAGAGGGTAGCGGAATTCATGG","TACGGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGAGTACGTAGGTGGTTTATTAAGTCAGATGTGAAATCCCTGAGCTTAACTTAGGAACTGCATTTGAAACTGATAAACTAGAGTTTCGTAGAGGGGGGTAGAATTCCAGG","TACGGAGGATGCGAGCGTTATCCGGATTTATTGGGTTTAAAGGGTGCGCAGGCGGACCATCAAGTCAGCGGTAAAATCGTGGGGCCCAACCCCATCCCGCCGTTGAAACTGGCGGTCTTGAGTGAGCGAGAAGTATGCGGAATGCGTGGT","TACGGAAGGTCCGGGCGTTATCCGGATTTATTGGGTTTAAAGGGAGCGTAGGCGGGCCGTTAAGTCAGTTGTGAAAGTTCGGGGCTCAACCCCGGAATTGCAGTTGAAACTGCCGGTCTTGAGTACACGCAGGGAAGCCTGAATTCATGG","TACGGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGAGTACGTAGGCGGTTTGTTAAGTCAGATGTGAAATCCCTGAGCTTAACTTAGGAACTGCATTTGAAACTGATGAACTAGAGTTTCGTAGAGGGAGGTAGAATTCCAGG","TACGAAGGGGGCTAGCGTTGTTCGGATTACTGGGCGTAAAGCGCGCGTAGGCGGATGTTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGCATCTAGAGTGCAGGAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCGCGTAGGCGGATGTTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGCATCTAGAGTGCAGGAGAGGTAAGTGGAATTCCGGG","TACGAAGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCGCGTAGGCGGATGTTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGCATCTAGAGTGCAGGAGAGGTAAGTGGAATTCCGAGT","TACGTAGGGTGCTAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGCAGGTGGCGCTGTAAGACAGATGTGAAATCCCGGAGCTTAACTTCGGAATTGCATTTGTGACTGCAGTGCTGGAGTGTGGCAGAGGGGGGTGGAATTGCTCG","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGTGCGCAGGTGGCGCTGTAAGACAGATGTGAAATCCCGGAGCTTAACTTCGGAATTGCATTTGTGACTGCAGTGCTGGAGTGTGGCAGAGGGGGGTGGAATTGCTCG","TACGGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGCACGCAGGCGGTCTGTTAAGTCAGATGTGAAATCCCCGGGCTCAACCCGGGAACTGCATTTGAAACTGGCAGGCTTGAGTCTCGTAGAGGGGGGTAGAATTCCAGG","TACGTAGGGTGCGAGCGTTGTCCGGAATTACTGGGCGTAAAGGGCTCGTAGGTGGTTTGTCGCGTCGTCTGTGAAATTCCGGGGCTTAACTCCGGGCGTGCAGGCGATACGGGCATAACTTGAGTACTGTAGGGGTAACTGGAATTCCTG","TACATAGGTGGCAAGCGTTATCCGGATTTATTGGGCGTAAAGCGTGCGTAGACGGTTTTGCAAGTCTGAGGTTAAATTTAGGGGCTCAACCCCTAACCGCCTTGGAAACTACATTACTAGAGTATAGGAGAGGTTAGTGGAATTTCATGT","TACGTAGGTGGCAAGCGTTATCCGGATTTATTGGGCGTAAAGGGAACGCAGGCGGTCTTTTAAGTCTGATGTGAAAGCCTTCGGCTTAACCGGAGTAGTGCATTGGAAACTGGGAGACTTGAGTGCAGAAGAGGAGAGTGGAACTCCATG","TACGGAGGATGCGAGCGTTATCCGGATTTATTGGGTTTAAAGGGTGCGCAGGCGGTCTGTTAAGTCAGCGGTCAAAGCCCGGGGCTCAACCCCGGCCCGCCGTTGAAACTGGCAGTCTCGAGTTGGAGAGAAGTATGCGGAATGCGCGGT","TACGGAGGATTCAAGCGTTATCCGGATTTATTGGGTTTAAAGGGTGCGTAGGCGGTCGGATAAGTTAGAGGTGAAATCCCGAGGCTCAACTTCGGAATTGCCTCTGATACTGTTCGGCTAGAGAGTAGTTGCGGTAGGCGGAATGTATGG","TACAGAGGATGCAAGCGTTATCCGGAATGATTGGGCGTAAAGCGTCTGTAGGTGGCTTTTTAAGTCCGCCGTCAAATCCCAGGGCTCAACCCTGGACAGGCGGTGGAAACTACCAAGCTGGAGTACGGTAGGGGCAGAGGGAATTTCCGG","AACATAGGTCACGAGCATTATCCGGATTTATTGGGCGTAAAGGAAGCGTAGGCGGGGAGGTTGATCCATTGTTAAAAGCATTTGCTTAACAAATGTGTGCATTGGAGATCGCCTCCCTAGAGTTAATCAGGGGGTACTGGAATTCAATGT","TACAGAGACTGCGAGCGTTATTCGGATTCACTGGGCGTAAAGGGTGCGTAGGCGGTCGTGTGTGTTAGGTGTGAAAGCCCGAGGCTCAACCTCGGAACTGCGCCTAAAACTACACGACTAGAGTATTGGAGAGGGTAGCGGAATTCATGG","CACGGGCTCCTTGCGTCCCCAGTTTAGTATGAAATGTTACATGAAGATGGTCAAGTCGTGCCATACGCTGGTCTAGAGGTTTTTTCAGATCAAGCTTGAATCTCTCAGCTGAGGCGGAAAGCCTATTTAGATCGGGCAGCGGCATTTGGT","TGCACCGAGTGACTTAGCCGTTTATTACGAATAACACGATCAAAAGCGTAATTGATCACACGCTCATTGACCGTATAAATTTCCGTTGATAATCTCGCGAGACAACGTGGCGCGCGCGGAATAAATCACGACGTGACAGTTCGCACCGCG","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGTATCTAGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","GActaattatgtaagaaaaataatatattaattttaataatttggaattttaaattaaattttaAGGTAAAAttttttttttttGGTGGAATATGAAAATTATTTGGATGTTAGAGTTTAATTATAAATATAAATTATAATAAGTTGAAT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGTATCTAGAGTGCAGAAGAGGTAAGTGGAATTCCGTG","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGTATCTAGAGTGCAGAAGAGGTAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGTATCTAGAGTGCAGAAGAGGTAAGTGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGTATCTAGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","AAAACGCCCGATGTCGCCATATAAGACGCGTTCTGTGCCGCGCGCAGCGGACAGGTATTGATTGAATTTACCCTGTAAACGACCGATTGTGTCGATATTCTGGTACACGGCGGAAATATTCGGAACACGTGACTCTGCTTCGTCTCCGAT","TACGAAGGGGGCTAGCGTTGTTCGGATTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGTATCTAGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGTATCTAGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","CCTAGACTATACCCGTGTTAGAGCCCCTTTTGATGGCACCGTGCTGGCGACTGTTGTGCAGGAGGGCCAGAATGTCAACGCCGTACAATCAGCACCGACCATTGTTATTCTGGGAGATCTTTCTATCATGACCGTACAGACGGAAATTTC","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGTATCTAGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGTATCTAGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGTAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGTAGGCGGCTTTGCAAGACAGGTGTGAAATCCCGTGGCTTAACCTCGGAACTGCATTTGTGACTGCATGGCTAGAGTGTGATAGAGGGGGGTAGAATTGTTTG","TACGAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGTATCTAGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGTATCTAGAGTGCAGAAGAGGTAAGTGGAATTCCGGG","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGTATCTAGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGTATCTAGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTGATACTGGGTATCTAGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGTAGGGCGCGAGCGTTGTCCGGAATTATTGGGCGTAAAGAGCTTGTAGGCGGTTTGTCGCGTCTGCTGTGAAAGGCCGGGGCTTAACCCCGTGTATTGCAGTGGGTACGGGCAGACTAGAGTGCAGTAGGGGAGACTGGAATTCCTG","ACGGCTGCAACAGTTCGCCGAATCGTCGGCGCACACACAACGGTAGATTTCGCGAAGATCTTAGGTTCCGCAGATTCCTTCCCCTCCAAATCCCGCGCGCCGCGAGACCTTCGCAAACTTAGCTCTCGCCCCTGCTATCCTATTTCGCGT","TACGTAGGGTGCTAGCGTTAATCGGAATTACTGGGCGTAAAGTGTGCGCAGGCGGCGTTGTAAGACAGATGTGAAATCCCGGAGCTTAACTTCGGAATTGCATTTGTGACTGCATTGCTGGAGTGCGGAAGAGGGGGGTGGAATTGCTCG","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCGCGTAGGCGGATGTTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGCCATCTAGAGTGCAGAAGAGGTAAGTGGAATTGCTCG","TACGAAGGGGGCTAGCGTTGTTCGGATTACTGGGCGTAAAGCGCGCGTAGGCGGATGTTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGCCATCTAGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGCGTAAAGCGCGCGTAGGCGGATGTTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGCCATCTAGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCGCGTAGGCGGATGTTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGCCATCTAGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCGCGTAGGCGGATGTTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGCCATCTAGAGTGCAGAAGAGGTAAGTGGAATTCCGAT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCGCGTAGGCGGATGTTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTGATACTGGCCATCTAGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCGCGTAGGCGGATGTTTAAGTCAGAGGTGAAATCCCAAGGCTAACCTTGGAATTGCCTTTGATACTGGCCATCTAGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCGCGTAGGCGGATGTTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGCCATCTAGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCGCGTAGGCGGATGTTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGCCATCTAGAGTGCAGAAGAGGTAAGTGGAATTCCGGG","TACGAAGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCGCGTAGGCGGATGTTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGCCATCTAGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCGCGTAGGCGGATGTTTAAGTCAGAGGTGAAATCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGCCATCTAGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGGAGAGGGCTAGCGTTATTCGGAATCATTGGGCGTAAAGGGCGCGTAGGCGGGTTAGTAAGTTAAAAGTGAAATCCCAAGGCTCAACCTTGGAACTGCTTTTAAAACTGCTAGTCTAGAGATTGAAAGAGGATAGAGGAATTCCTGG","TACGGAGAGGGCTAGCGTTATTCGGAATCATTGGGCGTAAGGGCGCGTAGGCGGGTTAGTAAGTTAAAAGTGAAATCCCAAGGCTCAACCTTGGAACTGCTTTTAAAACTGCTAGTCTAGAGATTGAAAGAGGATAGAGGAATTCCTAGT","GACTAATcatttgagagagtttttacgattaagtatttttttatttagatgagttagatttttaagttagttttttttttttaGTGAAATATGAAAACTATTATAGGTTAAAGATTTAATTAAGAAATAAAGTACAATAAACTAGAAAAT","GACTAATcatttgagagagtttttacgattaagtatttttttatttagatgagttagatttttaagttagttttttttttttaGTGAAATATGAAAACTATTATAGGTTAAAGATTTAATTAAGAAATAAAGTACAATAAACTAAAAAAT","GACTAATcatttgagagagtttttacgattaagtatttttttatttagatgagttagatttttaagttagtttttttttttttAGTGAAATATGAAAACTATTATAGGTTAAAGATTTAATTAAGAAATAAAGTACAATAAACTAGAAGG","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCGCGTAGGCGGATGTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGCCATCTAGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGGAGAGGGCTAGCGTTATTCGGAATCATTGGGCGTAAAGGGCGCGTAGGCGGGTTAGTAAGTTAAAAGTGAAATCCAAGGCTCAACCTTGGAACTGCTTTTAAAACTGCTAGTCTAGAGATTGAAAGAGGATAGAGGAATTCCTAGT","TACGGAGAGGGCTAGCGTTATTCGGAATCATTGGGCGTAAAGGGCGCGTAGGCGGGTTAGTAAGTTAAAAGTGAAATCCCAAGGCTCAACCTTGGAACTGCTTTAAAACTGCTAGTCTAGAGATTGAAAGAGGATAGAGGAATTCCTAGT","TACATAGGTGGCAAGCGTTATCCGGATTTATTGGGCGTAAAGGGTGCGTAGACGGTTTTGTAAGTCTGAGGTTAAATATGAGAGCTCAACTCTCATTCGCCTTGGAAACTGCAAGGCTAGAGTATAGGAGAGGCTAGTGGAATTCCATGT","TACGGAGGGTGCTAGCGTTAATCGGAATTACTGGGCGTAAAGAGTACGTAGGTGGTTTATTAAGTCAGATGTGAAATCCCTGAGCTTAACTTAGGAACTGCATTTGAAACTGATAGACTAGAGTTTCGTAGAGGGAGGTAGAATTCCAGG","TACGTAGGTGGCGAGCGTTATCCGGAATTATTGGGCGTAAAGGGTGCGCAGGCGGTAGTAAAAGATTGTGGTTAAAGAATGGAGCTCAACTCCATAATGCCATGATAACTTTACAACTAGAGTGCAGAAGAGGAGAGTGGAATTCCATGT","AACTAATCATGTGAGAAAAATAATATATTAATTTTAATAATTTAGAATTTTAGGTTAGATTTTAAGATAAAAttttttttttttGGTGAAATATGAAAATTACTTAAATATTAGAATTTAATTATAAATATAAATTATAATAAGTTAAAT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGTATCTGGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGACATTTAAGTCAGAGGTGAAATCCCAGGGCTCAACCTTGGAACTGCCTTTGATACTGGTGTCTTGAGTATGGAAGAGGTGAGTGGAATTCCGAGT","TACGGAGGGTGCAAGCGTTATCCGGATTTACTGGGTTTAAAGGGTGTGTAGGCGGGCTTTTAAGTCTGGGGTGAAATCCCGAAGCTCAACTTCGGAACTGCCTTGGATACTATTAGTCTTGAATTATGTTGAGGTTGGCGGAATATAACG","TACGGAGGGTGCAAGCGTTATCCGGATTTACTGGGTTTAAGGGTGTGTAGGCGGGCTTTTAAGTCTGGGGTGAAATCCCGAAGCTCAACTTCGGAACTGCCTTGGATACTATTAGTCTTGAATTATGTTGAGGTTGGCGGAATATAACAT","TACGGAGGGTGCAAGCGTTATCCGGATTTACTGGGTTTAAAGGGTGTGTAGGCGGGCTTTTAAGTCTGGGTGAAATCCCGAAGCTCAACTTCGGAACTGCCTTGGATACTATTAGTCTTGAATTATGTTGAGGTTGGCGGAATATAACAT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGTATCTGGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGTATCTGGAGTGCAGAAGAGGTAAGTGGAATTCCGAT","TACGGAGGGTGCGAGCGTTAATCGGAATTACTGGGCGTAAAGAGTACGTAGGTGGTTTATTAAGTCAGATGTGAAATCCCTGAGCTTAACTTAGGAACTGCATTTGAAACTAGTAGGCTAGAGTTTCGTAGAGGGGGGTAGAATTCCAGG","TACGTAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGCAGGCGGACTTGTAAGACAGAGGTGAAATCCCCGGGCTTAACCTGGGAACTGCCTTTGTGACTGTGAGTCTGGAGTGCGGCAGAGGGGGATGGAATTCCGCG","CTGGCACGGATACGCTCATAAGCGGTCAGTAAACGTTCTTCAACTTTAGCTTTGGCAACTTCGGAACTCTTGACCAGCTCCTTTTCCTCAGCTTCTGTTTCTTTAATGATCTTATCTAATTCTTTACGTTTAACATCCAGCATATCCTGT","TACGAAGGGGGCTAGCGTTGTTCGGATTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGTATCTGGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGTATCTGGAGTGCAGAAGAGGTAGTGGAATTCCGAGT","TACGAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGTATCTGGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGTATCTGGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGGAGGGTGCAAGCGTTATCCGGATTTACTGGTTTAAAGGGTGTGTAGGCGGGCTTTTAAGTCTGGGGTGAAATCCCGAAGCTCAACTTCGGAACTGCCTTGGATACTATTAGTCTTGAATTATGTTGAGGTTGGCGGAATATAACAT","CCTAGACTATACCCGTGTTAGAGCCCCTTTTGATGGTACCGTGCTGGCGACTGTTGTGCAGGAGGGCCAGAATGTCAACGCCGTACAATCAGCACCGACCATTGTTATTCTGGGAGATCTTTCTATCATGACCGTACAGACGGAAATTTC","AACTAATGGGCACCGTGCAGTGCAAATTGCCACCATCGCGCTCAAAAATATCGTGTTTTTTAACACGAATTTCAATATATAAATCTCCTGGAGAGCCTCCATTAGTACCGGGCTCACCGTTACCGCTACTGCGAATACGCATCCCGTCTT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTGATACTGGGTATCTGGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGTATCTGGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGTAGGGTGCGAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGCAGGCGTCTTTGTAAGACAGGTGTGAAATCCCGGGGCTTAACCTCGGAATTACATTTGTGACTGCAATGATAGAGTGCGATAGAGGGGGGTAGAATTGTTTG","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGTATCTGGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGTATCTGGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGGTATCTGGAGTGCAGAAGAGGTAAGTGGAATTCCGGG","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGACATTTAAGTCAGAGGTGAAATCCCAGGGCTCAACCTTGGAACTGCCTTTGATACTGGGTGTCTTGAGTATGGAAGAGGTGAGTGGAATTCCGGG","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGACATTTAAGTCAGAGGTGAAATCCAGGGCTCAACCTTGGAACTGCCTTTGATACTGGGTGTCTTGAGTATGGAAGAGGTGAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGTGCGCAGGCGTCTTTGTAAGACAGGTGTGAAATCCCGGGGCTTAACCTCGGAATTACATTTGTGACTGCAATGATAGAGTGCGATAGAGGGGGGTAGAATTGTTTG","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTAACCTTGGAATTGCCTTTGATACTGGGTATCTGGAGTGCAGAAGAGGTAAGTGGAATTCCGAGT","TACGGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGAGTACGTAGGTGGTTTACTAAGTCAGATGTGAAATCCCTGAGCTTAACTTAGGAACTGCATTTGAAACTAGTAGGCTAGAGTTTCGTAGAGGGGGGTAGAATTCCAGG","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGTTATCTAGAGTGCAGGAGAGGTAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGTTATCTAGAGTGCAGGAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGTTATCTAGAGTGCAGGAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGTTATCTAGAGTGCAGGAGAGGTAAGTGGAATTCCGAGT","TACGTAGGGTGCTAGCGTTAATCGGAATTACTGGGCGTAAAGCGTGCGCAGGCGGTGCTGTAAGACAGATGTGAAATCCCGGGGCTTAACTTCGGAATTGCATTTGTGACTGCAGCGCTGGAGTGTGGCAGAGGGGGGTAGAATTGCTCG","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGTGCGCAGGCGGTGCTGTAAGACAGATGTGAAATCCCGGGGCTTAACTTCGGAATTGCATTTGTGACTGCAGCGCTGGAGTGTGGCAGAGGGGGGTAGAATTGCTCG","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGTTATCTAGAGTGCAGGAGAGGTAAGTGGAATTCCGGG","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGTTATCTAGAGTGCAGGAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGTTATCTAGAGTGCAGGAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTGATACTGGTTATCTAGAGTGCAGGAGAGGTAAGTGGAATTCCGAGT","TACGAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGTTATCTAGAGTGCAGGAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGTTATCTAGAGTGCAGGAGAGGTAAGTGGAATTCCGAGT","TACGAAGGGGGCTAGCGTTGTTCGGATTTACTGGGCGTAAAGCGCACGTAGGCGGATATTTAAGTCAGAGGTGAAATCCCAAGGCTCAACCTTGGAATTGCCTTTGATACTGGTTATCTAGAGTGCAGGAGAGGTAAGTGGAATTCCGTG"];
      var samples = ["10343.JS0932","10343.JS0933","10343.JS1089","10343.JS1088","10343.JS1090","10343.JS1155","10343.JS1068.b","10343.JS1068.c","10343.JS1153","10343.JS1068.a","10343.JS1936","10343.JS1934","10343.JS1935","10343.2025a","10343.2024a","10343.2026a","10343.JS2174","10343.JS2195.f","10343.JS2195.e","10343.JS2170","10343.JS2195.d","10343.JS2184","10343.JS2183","10343.JS1180.c","10343.JS2185","10343.JS1180.b","10343.JS1180.a"];
      var vlines = ["2.0","5.0","10.0","13.0","16.0","21.0"];
      var xtick_pos = ["1.0","3.5","7.5","11.5","14.5","18.5","24.0"];
      var xtick_labels = ["JS-C-085","JS-C-095","JS-C-099","JS-C-166","JS-C-175","JS-C-188","JS-C-189"];
      var field_name = "colony";
      var title_text = "dolychonderus";
      //***********************************************************

      var yaxiswidth = 100;
      var xaxisheight = 20;

      // set the title
      $('#field_name').html(field_name);
      $('#title_text').html(title_text);

      var svg = d3.select('svg');

      var width = $('#div-heatmap').width();
      var height = $('#div-heatmap').height();

      // available display for the heatmap (without axes)
      var hwidth = width - yaxiswidth;
      var hheight = height - xaxisheight;

      svg.attr('width', width)
          .attr('height', height);

      svg.on('click', onclick);

      var xScale = d3.scaleLinear()
          .domain([0, width])
          .range([0, width]);

      var yScale = d3.scaleLinear()
          .domain([0, ids.length])
          .range([0.5, hheight + 0.5]);

      var heatmapregion = svg
          .append('svg')
          .attr('width', width - yaxiswidth + 'px')
          .attr('height', height - xaxisheight + 'px')
          .attr('x', yaxiswidth)
          .attr('y', 0);

      var heatmap = heatmapregion.append('g')
          .append('image')
          .attr('class', 'pixel')
          .attr('width', samples.length)
          .attr('height', ids.length)
          .attr('xlink:xlink:href', 'data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAABsAAAB5CAYAAADI6FoEAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAuIwAALiMBeKU/dgAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDIuMS4yLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvNQv5yAAACV5JREFUaIG9mmtwG9UVgL/d1Uq25NhKTEwCSVw/kpDESZyA7QwQWspAIKQMhU5KSDoF2mYYWoqJTUNbAnlASGJJ006hM512pkNph6GUtj/opC%2BmBcobJpQ04ZGUvO0Ex8ayLVnSavf2xzpyZGtl7UrbM3NH0t179e2559x7zz27EiDIIfO2RhCK4NCWDhofDbNm9Zu0TfkvLw4s5BctT%2BfqMqlIVrDx0rL3Qfrfm05w6VneXf24I5hcaMNyVUNqiDEUL3MEsgWLpbxoCY9jkC3YzbPfp7nuBLfOfc8xrOBbXTVlPxeqUZrLjuPMYjY0e37gMgCe7r/cIcoGrDlwjEt83XwpuM8xrOBhfPTgagK%2BFGldAXa6C4sNlZF%2Bdyq6t6BpWRyMPh9yCmRN%2Bj/AqpPEZS%2B%2Bs4r7MCOmUt6roA45ZgEgPjg%2BU2CukQWV5rvDBbddes95bef9blvWxatu2J2zQ31XNqD19lDm%2B3XNWzLX224Lidb1ITFva0QAovGxsFixtksAYsI8G55pjmzLhhAAl94RBkBJwOL7Ipl26fIxR0nMCCDpY/%2BRCMqU9Y39VuMGV960B/njrzzCB8dn0vC4%2BafqiOnaIxeY9/HM9i60gMShLR0ALPh%2BhOa7w2gBEzbn57spOx1D9wn6T12MUKBswABg5ZrdpAMCzS%2Bj%2BWX47aHlAhANjxduhwUPRmzZ%2BFyRNWHflXWf7S4ZyaI3PLs92xH%2BvNmRFuPLlTftEZmwoPbJLjzDMhf/M83Lezc7v/U8kvHG1W3mpnj0ZufL0WSSWUHe6Z2NGpWQdOfL0WSSGcboqVlUyGYwo8w87Aoso9lDZ67kpZONJDUPsNUVGIx6y/znt5ZsnjW1576ecZD0x1Ms72bpPWFbd/%2BfH23Kr5lVuervHQVpW/uEudhe27rNut0db96R9092HVg1oW75n36Qt8/CzRbD%2BPWaf%2BUdklf7GifUnT0ZzNvHM5y7Xt6fmJ234/4TF02s9OkT686T95/MbTP5uwv%2BAZDZYsbLglmnJ9RNe8ObF2YlGW/0LYjmbLCoqmdCXTKYf0mbtzVieS3b%2BHeFRVN7RCz71tj%2Bdn4c0XR/tvEbdpvXlm00P69v6BQrbxwLLRZ1ZLW3npRZwYqN0ro%2BlLPe8uS55NsR0gE4uMd6gtqRtttC1sfcpvYIUw9paBUKsiZ47fcPFA20PMXEZwoGaz288WwnyaqCDzvOYN6o6XGfX7WLd3/Z4R6sLhxCeKDyWJqX/vJgSUCWsCMdnVR%2BYjDQqAL2V30ryekgdeEQclpCSKAOSXy0ozQemfMUEzgho8YEqUqJA%2BHiQSvX7EbIUm5YbLaBlJaQdVPpy2/pKsr1X3nBDA1zwrxRGSkNShJWfDXEa892OgadLzkdJFVloKRAq4A3SgSyhEm6RNoPWpVRMpAlLF2TQgsI9IDBso1hmtqttwy7krUyt60LCb2nUaS664Xe0yh2HVgl9J5GR6v/%2BJJznjW1R0jUCMrPSHhGBIYH/v3T4pesnN6ofz5KmWwgNQn6j%2BYPboqGGfuqSFYI1CGJysFR/d2CqYMwcpGO4ZVREjKiuJxmRnJ6oy8qKD/pQdLBEwdvNOf%2B6kgmD61/tdPy2ud%2BHBLXXLEj8/vqq822S%2B6NZAKe5XeF88cgLRtCxC6SHcUgretDvPWbTlo2hIhfKOP/1EDIUmGa5StDp%2BYIvadRxLtrxR8OLxF6T6OY87M9Vu2LgzXsDourrt81YRhzlaL9zJidQB0ymL8lwrQPdTirWbYtSdikHutFScDrzz2AJ%2BYizNCzZ7zSlz8hWZTNap/emXH9c%2B5uVYrWTPEYKLEUyzaGGZkO1zdYb7ZFw/S0TGJGAIDyXtCrrRMBRcNEWkYd0ui/IoUWgNgsv3uwGxfvp3%2BBn4pgnMTSOP2XWKejip5nr5%2BupfqDOEcbg5QNSJT3Wi/aRWs2HC9Dm6IiayAU8CRchB1e%2BzB9TV5mrOjhw8c2kayy3mlLc/AC4pp5CFFj1m1KBrvAb1J6L7OONUsCqzqi89GpCwEIHLf2xpLAlKSBkTAh/k9ddBCA8pPD%2BLpNm/nPuLzFDDdUolWaGhmq9V%2BWJEiTdIFUkxyF2XD9JffmP0Q03T/x%2Bqt//B7eg%2Baa6IlbZ%2BwmwN7/ibNjrZIwP339yaz6RR1jN1eQzS69M3%2B24Oov7uRgl3mTA/MDWdd0H6xY2wXYeGvCiVx6Z5jENNOGyWpRuhXkfJn/sDl0/t40B8Kb8A4J5uwdcQf20fZsu2sBicH68tywpvYITe0RWtebjyLrnnnUFmxRp6mZ5peZ%2B9w2DC%2B885R5mJw0gpr3iL0ngcu%2BOZYUnbt9rG9Bk9pu1qCiJ535npqqc80VO0hW%2BwrTzG5Z1BkRl/wwIlauMXPFLV8LlSbWzyVSGtJBwSsvbGbpPWGSo8elCQ7Sti40oXOuSb38G9YTXR0WHH7IdIhkUKLqqLkTlGRSX9e8hb%2B%2BtwOAa1u38be3HgHMbNzgHA%2BVx9OlOQzmKos6xzxw7nPbMjl/V2yWqjQ/l3wnQnI/6F5YuDlSmv1svBiqaRndZzqLJy7wDpVo8xwv515q0H1mzjJ2sYQ36hLMOzTq6hp4RgRKUsI7VOCqf/ktXbZgvj5zGM/tcdP3xXjnqY7CYHbzw58tNmEr1nYRnyHRu8zcUF0ZRl/fmA6GV%2BD/1KDttpA7%2B5nuE9Q%2B0UWySkYdlEhVyEQbZHdghhfklMTIdAklCVqFhJJwKQZJddcDoEgyujBQJFMnV2zWuHcjaDKBYx4S1YKys5J5UHQDJiUVMEBIpoOk/RKS4RKsps58D%2BpMeRCPP03Sr4LHcMdB4i/W8PYNuwju8/LJuocoO6EyZb/PHZh3wPQ5afTBkayZuSRXYJ5be/nCi5sYucZ8yUBp%2B4zhhSl3bJZ8oQYGDaYlR2fVy1OpHk1qZ%2B2ybetyP9AGxOL7xnbg1ttDomnT5PHk%2BU/gHU3qtnUhvFGd3maVD3cWfsRyZLPP5pnd/Kft3acjmOETJIMK8Rn2nps4cpBUTZpog8rIrPTkjcdJTsO2bLB2lER3nUh114tEd52tEM9Ss7d/bZ1%2B/fKhNcQ0L/VT%2BoAjBWvlaBiP9E0jlVTxyPZON45g%2BoFKgkfheP0s92HpchhsAL1uxFY/R64vGaCMSOjDqvswOZ0/iVlSmH7utSvD3qR2BPOMjB4YBu295fk/xxH5AGBQPnEAAAAASUVORK5CYII%3D')

      var xyratio = get_xyratio();

      var scalex = 1;
      var scaley = 1;

      var xAxis = d3.axisBottom(xScale)
          .tickValues(xtick_pos)
          .tickFormat(function(d, i) {return xtick_labels[i];});

      function customTickFunction(d) {
        var dom = yAxis.scale().domain();
        if ((dom[1] - dom[0]) < 50) {
          return Math.round(dom[1] - dom[0]);
        }
        return 50;
      }

      var yAxis = d3.axisLeft(yScale)
          .ticks(50)
          .tickFormat(function(d) {
            try {
              var taxa = yticklabels[Math.round(d)].replace(/;+$/, '').split(';');
              var label = taxa.pop();
              while (label.length == 3 && label.substring(1,3) == '__') {
                label = taxa.pop()
              }
              if (taxa.length > 0) {
                 label = taxa.pop() + ' ' + label;
              }
            }
            catch(err) {
              label=''
            }
            return label;
          });
      yAxis.ticks(customTickFunction());

      var gY = svg.append('g')
          .attr('class', 'axis axis--y')
          .attr('transform', 'translate(' + yaxiswidth + ',0)')
          .call(yAxis);

      var gX = svg.append('g')
          .attr('class', 'axis axis--x')
          .attr('transform', 'translate(' + yaxiswidth + ',' + (hheight) + ')')
          .call(xAxis);

      // The per sample-type vlines
      var vline_lines = heatmapregion.append('g');
      for (idx=0;idx<vlines.length; idx++) {
        vline_lines.append('line')
            .attr('id', 'vline')
            .attr('class', 'vLine')
            .style('stroke', 'white')
            // .style('stroke-dasharray', '1,1')
            .style('stroke-opacity', 1)
            .style('stroke-width', 6 * xyratio)
            .attr('x1', vlines[idx]).attr('y1', 0)
            .attr('x2', vlines[idx]).attr('y2', ids.length);
      }

      // The cursor crosshair
      var focus = heatmapregion.append('g');

      var xline = focus.append('line')
          .attr('id', 'focusLineX')
          .attr('class', 'focusLine')
          .style('stroke', 'white')
          // .style('stroke-dasharray', '1,1')
          .style('stroke-opacity', 0.5)
          .style('stroke-width', 1);

      focus.append('line')
          .attr('id', 'focusLineY')
          .attr('class', 'focusLine')
          .style('stroke', 'white')
          .style("stroke-opacity", 0.5)
          // .style('stroke-dasharray', '1,1')
          .style('stroke-width', 1 * xyratio);

      d3.select('#reset')
          .on('click', resetted);

      d3.select('#zoomsplus')
          .on('click', zoomX);

      d3.select('#zoomsminus')
          .on('click', unzoomX);

      d3.select('#zoomfplus')
          .on('click', zoomY);

      d3.select('#zoomfminus')
          .on('click', unzoomY);

      d3.select('#movedown')
          .on('click', moveDown);

      d3.select('#moveup')
          .on('click', moveUp);

      d3.select('#moveright')
          .on('click', moveRight);

      d3.select('#moveleft')
          .on('click', moveLeft);

      var initial_scale_factor = hwidth / samples.length;

      var shiftdown = 0;
      var current_tx, current_scale_x, current_scale_y, current_ty;
      d3.select('body').on('keydown', onkeydown);
      d3.select('body').on('keyup', onkey);

      var zoom = d3.zoom()
          .scaleExtent([initial_scale_factor, 10000])
          .translateExtent([[0, 0], [width / initial_scale_factor, 100000000]])
          .on('zoom', zoomed);

      heatmapregion.call(zoom);

      // and initial zoom to have full screen
      resetted();

      function onkeydown() {
        if (d3.event.key == '-') {
          unzoomY();
          return;
        };
        if (d3.event.key == '=') {
          zoomY();
          return;
        };
        if (d3.event.key == '+') {
          zoomX();
          return;
        };
        if (d3.event.key == '_') {
          unzoomX();
          return;
        };
        if (d3.event.key == 'ArrowDown') {
          moveDown();
          return;
        };
        if (d3.event.key == 'ArrowUp') {
          moveUp();
          return;
        };
        if (d3.event.key == 'ArrowLeft') {
          moveLeft();
          return;
        };
        if (d3.event.key == 'ArrowRight') {
          moveRight();
          return;
        };
        // and now process the shift
        onkey();
      }

      function onkey() {
        shiftdown = d3.event.shiftKey;
        if (shiftdown) {
          xyratio = xyratio * current_scale_y / current_scale_x;
          current_scale_y = current_scale_x;
          current_tx = current_tx / (current_scale_x);
        } else {
          xyratio = xyratio * current_scale_y / current_scale_x;
          current_ty = current_ty / current_scale_x;
        }
      }

      function zoomed() {
        tt = d3.event.transform
        // if shift pressed we're in x-axis zoom/move mode
        if (shiftdown != 0) {
          current_tx = tt.x;
          current_scale_x = tt.k;
          gX.call(xAxis.scale(d3.event.transform.rescaleX(xScale)));
          vline_lines.selectAll('#vline').style('stroke-width', 3 / tt.k);
          focus.selectAll('#focusLineY').style('stroke-width', 2 / tt.k);
        };
        // if no shift pressed - we're in y-axis move/zoom mode
        if (shiftdown != 1) {
          current_ty = tt.y;
          current_scale_y = tt.k;
          ytransform = d3.zoomIdentity.translate(tt.x, tt.y).scale(tt.k * xyratio);

          // for the y-axis we need to update the scale since it's already scaled by ids/hheight
          ytransform2 = d3.zoomIdentity.translate(tt.x, tt.y).scale(tt.k * xyratio * ids.length / hheight);
          gY.call(yAxis.scale(ytransform2.rescaleY(yScale)).ticks(customTickFunction()));

          focus.selectAll('#focusLineX').style('stroke-width', 2 / (xyratio * tt.k));
        };
        newt = 'translate(' + current_tx + ',' + current_ty + ') scale(' + current_scale_x + ',' + current_scale_y * xyratio + ')';
        heatmap.attr('transform', newt);
        vline_lines.attr('transform', newt);
        focus.attr('transform', newt);
      }

      function reset_coords() {
        xyratio = get_xyratio();
        current_tx = 0;
        current_scale_x = initial_scale_factor;
        current_ty = 0;
        current_scale_y = initial_scale_factor;
      }

      function resetted() {
        console.log('reset coordinates');
        reset_coords();
        old_shiftdown = shiftdown;
        shiftdown = 2;
        heatmapregion.call(zoom.transform, d3.zoomIdentity.scale(initial_scale_factor));
        shiftdown = old_shiftdown;
        // The nice transition didn't work with the shift up/down
        // heatmapregion.transition()
        //     .duration(750)
        //     .call(zoom.transform, d3.zoomIdentity.scale(initial_scale_factor));
      }

      function zoomX() {
        old_shiftdown = shiftdown;
        shiftdown = 1;
        ctrans = d3.zoomTransform(heatmapregion.node());
        ctrans.x = 0;
        ctrans.k = ctrans.k * 2;
        // the leftmost feature showing in the screen
        screen_start = xAxis.scale().invert(0);

        // move so 0th sample is left column displaying
        heatmapregion.call(zoom.transform, ctrans);

        zoom.translateBy(heatmapregion, 0, 0);
        zoom.scaleBy(heatmapregion,1);
        newpos = xAxis.scale()(screen_start);
        newpos = -newpos;
        ctrans.x = newpos;
        heatmapregion.call(zoom.transform, ctrans);
        shiftdown = old_shiftdown;
      }

      function unzoomX() {
        old_shiftdown = shiftdown;
        shiftdown = 1;
        ctrans = d3.zoomTransform(heatmapregion.node());
        ctrans.x = 0;
        ctrans.k = ctrans.k / 2
        // the topmost feature showing in the screen
        screen_start = xAxis.scale().invert(0);

        // move so 0th feature is top row displaying
        // zoom.translateBy(heatmapregion, 0, -tozero/xyratio)
        heatmapregion.call(zoom.transform, ctrans);

        zoom.translateBy(heatmapregion, 0, 0);
        zoom.scaleBy(heatmapregion,1);
        newpos = xAxis.scale()(screen_start);
        newpos = -newpos;
        ctrans.x = newpos;
        heatmapregion.call(zoom.transform, ctrans);
        shiftdown = old_shiftdown;
      }

      function zoomY() {
        ctrans = d3.zoomTransform(heatmapregion.node());
        ctrans.y = 0;
        // the topmost feature showing in the screen
        screen_start = yAxis.scale().invert(0);

        // move so 0th feature is top row displaying
        // zoom.translateBy(heatmapregion, 0, -tozero/xyratio)
        heatmapregion.call(zoom.transform, ctrans);

        xyratio = xyratio * 2;
        zoom.translateBy(heatmapregion, 0, 0);
        newpos = yAxis.scale()(screen_start);
        newpos = -newpos;
        ctrans.y = newpos;
        heatmapregion.call(zoom.transform, ctrans);
      }

      function unzoomY() {
        ctrans = d3.zoomTransform(heatmapregion.node());
        ctrans.y = 0;
        // the topmost feature showing in the screen
        screen_start = yAxis.scale().invert(0);

        // move so 0th feature is top row displaying
        // zoom.translateBy(heatmapregion, 0, -tozero/xyratio)
        heatmapregion.call(zoom.transform, ctrans);

        xyratio = xyratio / 2;
        zoom.translateBy(heatmapregion, 0, 0);
        newpos = yAxis.scale()(screen_start);
        newpos = -newpos;
        ctrans.y = newpos;
        heatmapregion.call(zoom.transform, ctrans);
      }

      function moveDown() {
        screen_start = yAxis.scale().invert(0);
        screen_end = yAxis.scale().invert(height - xaxisheight);
        old_shiftdown = shiftdown
        shiftdown = 0;
        zoom.translateBy(heatmapregion, 0, (screen_start - screen_end) * xyratio);
        shiftdown = old_shiftdown;
      }

      function moveUp() {
        screen_start = yAxis.scale().invert(0);
        screen_end = yAxis.scale().invert(height - xaxisheight);
        old_shiftdown = shiftdown
        shiftdown = 0;
        zoom.translateBy(heatmapregion, 0, (screen_end - screen_start) * xyratio);
        shiftdown = old_shiftdown;
      }
      function moveLeft() {
        screen_start = xAxis.scale().invert(0);
        screen_end = xAxis.scale().invert(width - xaxisheight);
        old_shiftdown = shiftdown
        shiftdown = 1;
        zoom.translateBy(heatmapregion, (screen_end - screen_start), 0);
        shiftdown = old_shiftdown;
      }
      function moveRight() {
        screen_start = xAxis.scale().invert(0);
        screen_end = xAxis.scale().invert(width - xaxisheight);
        old_shiftdown = shiftdown
        shiftdown = 1;
        zoom.translateBy(heatmapregion, (screen_start - screen_end), 0);
        shiftdown = old_shiftdown;
      }

      function onclick() {
        var pos = d3.mouse(heatmap.node());
        // var cx = Math.round(xScale.invert(pos[0])), cy = Math.round(yScale.invert(pos[1]));
        var cx = Math.round(pos[0]-0.5), cy = Math.round(pos[1]-0.5);
        // var posx = xScale.invert(pos[0]), posy = yScale.invert(pos[1]);
        var posx = pos[0], posy = pos[1];
        focus.select('#focusLineY')
            .attr('x1', Math.round(posx + 0.5) - 0.5).attr('y1', 0)
            .attr('x2', Math.round(posx + 0.5) - 0.5).attr('y2', ids.length);
        focus.select('#focusLineX')
            .attr('x1', 0).attr('y1', Math.round(posy-0.5) + 0.5)
            .attr('x2', samples.length).attr('y2', Math.round(posy-0.5) + 0.5);

        var cid = ids[cy];
        var csamp = samples[cx];
        try {
          var ctax = yticklabels[cy].split(';').map(function(e) {
            try {
              e = e.split('_').pop()
            } catch(err) {
              console.log('failed to split taxonomy on "_":');
              console.log(e)
              console.log(err)
            }
            return '<a href="https://en.wikipedia.org/wiki/' + e + '" target="_blank">' + e + '</a>'
          }).join('; ');
        } catch (err) {
          console.log('error when parsing taxonomy:');
          console.log(err);
          ctax = "No taxonomy in biom table";
        }
        $('#taxonomy').html(ctax);
        $('#sampleid').html(csamp);
        $('#sequence').html(cid);
        // Get dbBact annotations for selection
        $.ajax({
          url: 'http://api.dbbact.org/sequences/get_string_annotations',
          type: 'POST',
          data: JSON.stringify({'sequence': cid}),
          dataType: 'json',
          contentType: 'application/json; charset=utf-8',
          success: function(data) {
              if (data.annotations.length == 0) {
                atext = 'No annotations found for sequence'
              }
              else {
                var atext = '';
                var clink = 'http://dbbact.org/sequence_annotations/' + cid;
                var ctext = '<p><a href="' + clink + '" target="_blank">dbBact Summary</a></p>';
                atext += ctext;
                for (i = 0; i < data.annotations.length; i++) {
                    clink = 'http://dbbact.org/annotation_info/' + data.annotations[i].annotationid.toString();
                    ctext = '<a href="' + clink + '" target="_blank">' + data.annotations[i].annotation_string + '</a><br>';
                    atext += ctext;
                }
              }
              $('#p-annotation').html(atext);
          }
        });
      }

      function get_xyratio() {
        return (hheight / ids.length) * (samples.length / hwidth);
      }

      $(window).on('resize', function(){
        $('body').height('calc(100vh - 50px)');
      });
    });
  </script>
</head>
<body style="height: calc(100vh - 50px); min-height: 600px; min-width: 1080px;">
  <div>&nbsp;</div>
  <div id="div-annotation" class="panel panel-default" style="float: right; margin: 10px; width: 360px; height: auto; white-space: nowrap;">
    <!--Here goes the annotations!-->
    <div class="panel-heading">
      <b>dbBact annotations</b>
    </div>
    <div class="panel-body" style="overflow: auto;">
      <p id="p-annotation">Click on heatmap to see annotations</p>
    </div>
    <div class="panel-footer">
      For more analysis options, download <a href='https://github.com/amnona/calour' target='_blank'>Calour</a>.
    </div>
  </div>

  <div class="panel panel-default" style="margin: 10px; width: auto; height: 100%; overflow: hidden;">
    <div id="div-title" class="panel-heading">
      <b><span id="title_text">Experiment</span></b>
      (sorted by field: <b><span id='field_name'> NA </span></b>)
      <span style="float: right;">
        <button id="reset" class="btn btn-default btn-xs">Reset</button>
        <button id="zoomfplus" class="btn btn-default btn-xs">F+</button>
        <button id="zoomfminus" class="btn btn-default btn-xs">F-</button>
        <button id="zoomsplus" class="btn btn-default btn-xs">S+</button>
        <button id="zoomsminus" class="btn btn-default btn-xs">S-</button>
        <button id="moveup" class="btn btn-default btn-xs">&uarr;</button>
        <button id="movedown" class="btn btn-default btn-xs">&darr;</button>
        <button id="moveleft" class="btn btn-default btn-xs">&larr;</button>
        <button id="moveright" class="btn btn-default btn-xs">&rarr;</button>
        <button id="btn-help" class="btn btn-default btn-xs" onclick="$('#div-help').toggle();">Help</button>
      </span>
    </div>
    <div id="div-heatmap" class="panel-body" style="height: calc(100% - 100px);">
      <svg id="heatmap" style="width: 100%; height: 100%;)"></svg>
    </div>
    <div id="div-selection" class="panel-footer">
      <!--Here goes the selection!-->
      <span style="display: inline-block; float: left; overflow: hidden;"><b>Sample:&nbsp;&nbsp;</b></span>
      <span id="sampleid" style="display: inline-block; float: left; width: 120px; overflow: auto; white-space: nowrap;">NA</span>
      <span style="display: inline-block; float: left; overflow: hidden;">&nbsp;&nbsp;<b>Taxonomy:&nbsp;&nbsp;</b></span>
      <span id="taxonomy" style="display: block; overflow: auto; white-space: nowrap;">NA</span>
      <span style="display: inline-block; float: left; overflow: hidden;"><b>Sequence:&nbsp;&nbsp;</b></span>
      <span id="sequence" style="display: block; overflow: auto; white-space: nowrap;">NA</span>
    </div>
  </div>

  <div id="div-help" class="panel panel-info" style="display: none; position: fixed; left: 50%; width: 400px; margin-left: -200px; top: 200px; box-shadow: 10px 10px 5px rgba(0,0,0,0.5);">
    <div class="panel-heading">
      Help
      <span style="float: right;"><button class="btn btn-default btn-xs" onclick="$('#div-help').hide();">&times;</button></span>
    </div>
    <div class="panel-body">
      <p>Use mouse or -/= for zooming bacteria, shift+mouse or _/+ for zooming samples, arrow keys to move in heatmap.</p>
    </div>
  </div>
</body>
</html>
